/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (function() { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./js/index.js":
/*!*********************!*\
  !*** ./js/index.js ***!
  \*********************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _weavy_dropin_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @weavy/dropin-js */ \"./node_modules/@weavy/dropin-js/dist/weavy-dropin.js\");\n/* harmony import */ var _weavy_dropin_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_weavy_dropin_js__WEBPACK_IMPORTED_MODULE_0__);\n\n\n//Weavy.defaults.logging = { debug: true };\n\nvar getToken = function () {\n  return fetch('/token').then(response => response.text());\n};\n\nvar weavy = window.weavy = new (_weavy_dropin_js__WEBPACK_IMPORTED_MODULE_0___default())({\n    url: \"https://jojje.weavy.io\",\n  jwt: getToken,\n  stylesheet: [\n    \"/css/weavy-dark.css\",\n  ],\n});\n\nvar messenger = weavy.app({\n  id: \"my-messenger\",\n  type: \"messenger\",\n  container: \"#drawer\",\n  open: false,\n  badge: true,\n  //css: \".conversation .list-group-item { background: red; }\",\n  stylesheet: [\n    //\"/css/weavy-messenger.css\",\n    //\"/css/weavy-dark.css\",\n  ],\n  className: \"messenger-x\"\n})\n\n//messenger.addStyles(\"#my-messenger .conversation .list-group-item { color: white; }\");\n\ndocument.getElementById(\"messenger\").addEventListener(\"click\", () => messenger.toggle());\n\nmessenger.on(\"app-open\", () => document.getElementById(\"drawer\").classList.add(\"open\"))\nmessenger.on(\"app-close\", () => document.getElementById(\"drawer\").classList.remove(\"open\"));\nmessenger.on(\"badge\", (e, badge) => { setBadge(\"#messenger\", badge.count) });\n\nfunction setBadge(selector, count) {\n  var badge = document.querySelector(selector + \" .badge\");\n  if (typeof count === 'number') {\n    if (count > 0) {\n      if (!badge) {\n        badge = document.createElement(\"span\");\n        badge.className = \"badge bg-danger\";\n        document.querySelector(selector).append(badge);\n      }\n      badge.innerText = count;\n    } else {\n      if (badge) {\n        badge.remove();\n      }\n    }\n  }\n}\n\n\n\n//# sourceURL=webpack:///./js/index.js?");

/***/ }),

/***/ "./node_modules/@weavy/dropin-js/dist/weavy-dropin.js":
/*!************************************************************!*\
  !*** ./node_modules/@weavy/dropin-js/dist/weavy-dropin.js ***!
  \************************************************************/
/***/ (function(module) {

eval("!function(e,t){ true?module.exports=t():0}(self,(function(){return(()=>{var e={763:(e,t,n)=>{var o;self,o=function(){return(()=>{var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})}};e.g=function(){if(\"object\"==typeof globalThis)return globalThis;try{return this||new Function(\"return this\")()}catch(e){if(\"object\"==typeof window)return window}}(),e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"t\",{value:!0})};var t,o={};e.r(o),e.d(o,{AbortError:()=>s,DefaultHttpClient:()=>L,HttpClient:()=>p,HttpError:()=>r,HttpResponse:()=>h,HttpTransportType:()=>H,HubConnection:()=>M,HubConnectionBuilder:()=>K,HubConnectionState:()=>N,JsonHubProtocol:()=>Z,LogLevel:()=>t,MessageType:()=>A,NullLogger:()=>g,Subject:()=>q,TimeoutError:()=>i,TransferFormat:()=>F,VERSION:()=>f});class r extends Error{constructor(e,t){const n=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=n}}class i extends Error{constructor(e=\"A timeout occurred.\"){const t=new.target.prototype;super(e),this.__proto__=t}}class s extends Error{constructor(e=\"An abort occurred.\"){const t=new.target.prototype;super(e),this.__proto__=t}}class a extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType=\"UnsupportedTransportError\",this.__proto__=n}}class c extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType=\"DisabledTransportError\",this.__proto__=n}}class l extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType=\"FailedToStartTransportError\",this.__proto__=n}}class u extends Error{constructor(e){const t=new.target.prototype;super(e),this.errorType=\"FailedToNegotiateWithServerError\",this.__proto__=t}}class d extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=n}}class h{constructor(e,t,n){this.statusCode=e,this.statusText=t,this.content=n}}class p{get(e,t){return this.send({...t,method:\"GET\",url:e})}post(e,t){return this.send({...t,method:\"POST\",url:e})}delete(e,t){return this.send({...t,method:\"DELETE\",url:e})}getCookieString(e){return\"\"}}!function(e){e[e.Trace=0]=\"Trace\",e[e.Debug=1]=\"Debug\",e[e.Information=2]=\"Information\",e[e.Warning=3]=\"Warning\",e[e.Error=4]=\"Error\",e[e.Critical=5]=\"Critical\",e[e.None=6]=\"None\"}(t||(t={}));class g{constructor(){}log(e,t){}}g.instance=new g;const f=\"6.0.3\";class w{static isRequired(e,t){if(null==e)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,n){if(!(e in t))throw new Error(`Unknown ${n} value: ${e}.`)}}class v{static get isBrowser(){return\"object\"==typeof window&&\"object\"==typeof window.document}static get isWebWorker(){return\"object\"==typeof self&&\"importScripts\"in self}static get isReactNative(){return\"object\"==typeof window&&void 0===window.document}static get isNode(){return!this.isBrowser&&!this.isWebWorker&&!this.isReactNative}}function y(e,t){let n=\"\";return m(e)?(n=`Binary data of length ${e.byteLength}`,t&&(n+=`. Content: '${function(e){const t=new Uint8Array(e);let n=\"\";return t.forEach((e=>{n+=`0x${e<16?\"0\":\"\"}${e.toString(16)} `})),n.substr(0,n.length-1)}(e)}'`)):\"string\"==typeof e&&(n=`String data of length ${e.length}`,t&&(n+=`. Content: '${e}'`)),n}function m(e){return e&&\"undefined\"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&\"ArrayBuffer\"===e.constructor.name)}async function b(e,n,o,r,i,s,a){let c={};if(i){const e=await i();e&&(c={Authorization:`Bearer ${e}`})}const[l,u]=C();c[l]=u,e.log(t.Trace,`(${n} transport) sending data. ${y(s,a.logMessageContent)}.`);const d=m(s)?\"arraybuffer\":\"text\",h=await o.post(r,{content:s,headers:{...c,...a.headers},responseType:d,timeout:a.timeout,withCredentials:a.withCredentials});e.log(t.Trace,`(${n} transport) request complete. Response status: ${h.statusCode}.`)}class S{constructor(e,t){this.i=e,this.h=t}dispose(){const e=this.i.observers.indexOf(this.h);e>-1&&this.i.observers.splice(e,1),0===this.i.observers.length&&this.i.cancelCallback&&this.i.cancelCallback().catch((e=>{}))}}class E{constructor(e){this.l=e,this.out=console}log(e,n){if(e>=this.l){const o=`[${(new Date).toISOString()}] ${t[e]}: ${n}`;switch(e){case t.Critical:case t.Error:this.out.error(o);break;case t.Warning:this.out.warn(o);break;case t.Information:this.out.info(o);break;default:this.out.log(o)}}}}function C(){let e=\"X-SignalR-User-Agent\";return v.isNode&&(e=\"User-Agent\"),[e,I(f,P(),v.isNode?\"NodeJS\":\"Browser\",T())]}function I(e,t,n,o){let r=\"Microsoft SignalR/\";const i=e.split(\".\");return r+=`${i[0]}.${i[1]}`,r+=` (${e}; `,r+=t&&\"\"!==t?`${t}; `:\"Unknown OS; \",r+=`${n}`,r+=o?`; ${o}`:\"; Unknown Runtime Version\",r+=\")\",r}function P(){if(!v.isNode)return\"\";switch(process.platform){case\"win32\":return\"Windows NT\";case\"darwin\":return\"macOS\";case\"linux\":return\"Linux\";default:return process.platform}}function T(){if(v.isNode)return process.versions.node}function x(e){return e.stack?e.stack:e.message?e.message:`${e}`}class k extends p{constructor(t){if(super(),this.u=t,\"undefined\"==typeof fetch){this.p=new(n(350).CookieJar),this.m=n(350),this.m=n(350)(this.m,this.p)}else this.m=fetch.bind(function(){if(\"undefined\"!=typeof globalThis)return globalThis;if(\"undefined\"!=typeof self)return self;if(\"undefined\"!=typeof window)return window;if(void 0!==e.g)return e.g;throw new Error(\"could not find global\")}());if(\"undefined\"==typeof AbortController){this.v=n(350)}else this.v=AbortController}async send(e){if(e.abortSignal&&e.abortSignal.aborted)throw new s;if(!e.method)throw new Error(\"No method defined.\");if(!e.url)throw new Error(\"No url defined.\");const n=new this.v;let o;e.abortSignal&&(e.abortSignal.onabort=()=>{n.abort(),o=new s});let a,c=null;if(e.timeout){const r=e.timeout;c=setTimeout((()=>{n.abort(),this.u.log(t.Warning,\"Timeout from HTTP request.\"),o=new i}),r)}try{a=await this.m(e.url,{body:e.content,cache:\"no-cache\",credentials:!0===e.withCredentials?\"include\":\"same-origin\",headers:{\"Content-Type\":\"text/plain;charset=UTF-8\",\"X-Requested-With\":\"XMLHttpRequest\",...e.headers},method:e.method,mode:\"cors\",redirect:\"follow\",signal:n.signal})}catch(e){if(o)throw o;throw this.u.log(t.Warning,`Error from HTTP request. ${e}.`),e}finally{c&&clearTimeout(c),e.abortSignal&&(e.abortSignal.onabort=null)}if(!a.ok){const e=await O(a,\"text\");throw new r(e||a.statusText,a.status)}const l=O(a,e.responseType),u=await l;return new h(a.status,a.statusText,u)}getCookieString(e){let t=\"\";return v.isNode&&this.p&&this.p.getCookies(e,((e,n)=>t=n.join(\"; \"))),t}}function O(e,t){let n;switch(t){case\"arraybuffer\":n=e.arrayBuffer();break;default:n=e.text();break;case\"blob\":case\"document\":case\"json\":throw new Error(`${t} is not supported.`)}return n}class j extends p{constructor(e){super(),this.u=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new s):e.method?e.url?new Promise(((n,o)=>{const a=new XMLHttpRequest;a.open(e.method,e.url,!0),a.withCredentials=void 0===e.withCredentials||e.withCredentials,a.setRequestHeader(\"X-Requested-With\",\"XMLHttpRequest\"),a.setRequestHeader(\"Content-Type\",\"text/plain;charset=UTF-8\");const c=e.headers;c&&Object.keys(c).forEach((e=>{a.setRequestHeader(e,c[e])})),e.responseType&&(a.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{a.abort(),o(new s)}),e.timeout&&(a.timeout=e.timeout),a.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),a.status>=200&&a.status<300?n(new h(a.status,a.statusText,a.response||a.responseText)):o(new r(a.response||a.responseText||a.statusText,a.status))},a.onerror=()=>{this.u.log(t.Warning,`Error from HTTP request. ${a.status}: ${a.statusText}.`),o(new r(a.statusText,a.status))},a.ontimeout=()=>{this.u.log(t.Warning,\"Timeout from HTTP request.\"),o(new i)},a.send(e.content||\"\")})):Promise.reject(new Error(\"No url defined.\")):Promise.reject(new Error(\"No method defined.\"))}}class L extends p{constructor(e){if(super(),\"undefined\"!=typeof fetch||v.isNode)this.$=new k(e);else{if(\"undefined\"==typeof XMLHttpRequest)throw new Error(\"No usable HttpClient found.\");this.$=new j(e)}}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new s):e.method?e.url?this.$.send(e):Promise.reject(new Error(\"No url defined.\")):Promise.reject(new Error(\"No method defined.\"))}getCookieString(e){return this.$.getCookieString(e)}}class R{static write(e){return`${e}${R.RecordSeparator}`}static parse(e){if(e[e.length-1]!==R.RecordSeparator)throw new Error(\"Message is incomplete.\");const t=e.split(R.RecordSeparator);return t.pop(),t}}R.RecordSeparatorCode=30,R.RecordSeparator=String.fromCharCode(R.RecordSeparatorCode);class ${writeHandshakeRequest(e){return R.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,n;if(m(e)){const o=new Uint8Array(e),r=o.indexOf(R.RecordSeparatorCode);if(-1===r)throw new Error(\"Message is incomplete.\");const i=r+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(o.slice(0,i))),n=o.byteLength>i?o.slice(i).buffer:null}else{const o=e,r=o.indexOf(R.RecordSeparator);if(-1===r)throw new Error(\"Message is incomplete.\");const i=r+1;t=o.substring(0,i),n=o.length>i?o.substring(i):null}const o=R.parse(t),r=JSON.parse(o[0]);if(r.type)throw new Error(\"Expected a handshake response from the server.\");return[n,r]}}var A,N;!function(e){e[e.Invocation=1]=\"Invocation\",e[e.StreamItem=2]=\"StreamItem\",e[e.Completion=3]=\"Completion\",e[e.StreamInvocation=4]=\"StreamInvocation\",e[e.CancelInvocation=5]=\"CancelInvocation\",e[e.Ping=6]=\"Ping\",e[e.Close=7]=\"Close\"}(A||(A={}));class q{constructor(){this.observers=[]}next(e){for(const t of this.observers)t.next(e)}error(e){for(const t of this.observers)t.error&&t.error(e)}complete(){for(const e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new S(this,e)}}!function(e){e.Disconnected=\"Disconnected\",e.Connecting=\"Connecting\",e.Connected=\"Connected\",e.Disconnecting=\"Disconnecting\",e.Reconnecting=\"Reconnecting\"}(N||(N={}));class M{constructor(e,n,o,r){this.C=0,this.S=()=>{this.u.log(t.Warning,\"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://docs.microsoft.com/aspnet/core/signalr/javascript-client#bsleep\")},w.isRequired(e,\"connection\"),w.isRequired(n,\"logger\"),w.isRequired(o,\"protocol\"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this.u=n,this.k=o,this.connection=e,this.P=r,this.T=new $,this.connection.onreceive=e=>this.I(e),this.connection.onclose=e=>this._(e),this.H={},this.D={},this.A=[],this.R=[],this.U=[],this.N=0,this.L=!1,this.q=N.Disconnected,this.j=!1,this.M=this.k.writeMessage({type:A.Ping})}static create(e,t,n,o){return new M(e,t,n,o)}get state(){return this.q}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||\"\"}set baseUrl(e){if(this.q!==N.Disconnected&&this.q!==N.Reconnecting)throw new Error(\"The HubConnection must be in the Disconnected or Reconnecting state to change the url.\");if(!e)throw new Error(\"The HubConnection url must be a valid url.\");this.connection.baseUrl=e}start(){return this.W=this.O(),this.W}async O(){if(this.q!==N.Disconnected)return Promise.reject(new Error(\"Cannot start a HubConnection that is not in the 'Disconnected' state.\"));this.q=N.Connecting,this.u.log(t.Debug,\"Starting HubConnection.\");try{await this.F(),v.isBrowser&&window.document.addEventListener(\"freeze\",this.S),this.q=N.Connected,this.j=!0,this.u.log(t.Debug,\"HubConnection connected successfully.\")}catch(e){return this.q=N.Disconnected,this.u.log(t.Debug,`HubConnection failed to start successfully because of error '${e}'.`),Promise.reject(e)}}async F(){this.B=void 0,this.L=!1;const e=new Promise(((e,t)=>{this.X=e,this.J=t}));await this.connection.start(this.k.transferFormat);try{const n={protocol:this.k.name,version:this.k.version};if(this.u.log(t.Debug,\"Sending handshake request.\"),await this.V(this.T.writeHandshakeRequest(n)),this.u.log(t.Information,`Using HubProtocol '${this.k.name}'.`),this.G(),this.K(),this.Y(),await e,this.B)throw this.B}catch(e){throw this.u.log(t.Debug,`Hub handshake failed with error '${e}' during start(). Stopping HubConnection.`),this.G(),this.Z(),await this.connection.stop(e),e}}async stop(){const e=this.W;this.tt=this.et(),await this.tt;try{await e}catch(e){}}et(e){return this.q===N.Disconnected?(this.u.log(t.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve()):this.q===N.Disconnecting?(this.u.log(t.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this.tt):(this.q=N.Disconnecting,this.u.log(t.Debug,\"Stopping HubConnection.\"),this.st?(this.u.log(t.Debug,\"Connection stopped during reconnect delay. Done reconnecting.\"),clearTimeout(this.st),this.st=void 0,this.nt(),Promise.resolve()):(this.G(),this.Z(),this.B=e||new Error(\"The connection was stopped before the hub handshake could complete.\"),this.connection.stop(e)))}stream(e,...t){const[n,o]=this.it(t),r=this.rt(e,t,o);let i;const s=new q;return s.cancelCallback=()=>{const e=this.ot(r.invocationId);return delete this.H[r.invocationId],i.then((()=>this.ht(e)))},this.H[r.invocationId]=(e,t)=>{t?s.error(t):e&&(e.type===A.Completion?e.error?s.error(new Error(e.error)):s.complete():s.next(e.item))},i=this.ht(r).catch((e=>{s.error(e),delete this.H[r.invocationId]})),this.ct(n,i),s}V(e){return this.Y(),this.connection.send(e)}ht(e){return this.V(this.k.writeMessage(e))}send(e,...t){const[n,o]=this.it(t),r=this.ht(this.at(e,t,!0,o));return this.ct(n,r),r}invoke(e,...t){const[n,o]=this.it(t),r=this.at(e,t,!1,o);return new Promise(((e,t)=>{this.H[r.invocationId]=(n,o)=>{o?t(o):n&&(n.type===A.Completion?n.error?t(new Error(n.error)):e(n.result):t(new Error(`Unexpected message type: ${n.type}`)))};const o=this.ht(r).catch((e=>{t(e),delete this.H[r.invocationId]}));this.ct(n,o)}))}on(e,t){e&&t&&(e=e.toLowerCase(),this.D[e]||(this.D[e]=[]),-1===this.D[e].indexOf(t)&&this.D[e].push(t))}off(e,t){if(!e)return;e=e.toLowerCase();const n=this.D[e];if(n)if(t){const o=n.indexOf(t);-1!==o&&(n.splice(o,1),0===n.length&&delete this.D[e])}else delete this.D[e]}onclose(e){e&&this.A.push(e)}onreconnecting(e){e&&this.R.push(e)}onreconnected(e){e&&this.U.push(e)}I(e){if(this.G(),this.L||(e=this.lt(e),this.L=!0),e){const n=this.k.parseMessages(e,this.u);for(const o of n)switch(o.type){case A.Invocation:this.ut(o);break;case A.StreamItem:case A.Completion:{const n=this.H[o.invocationId];if(n){o.type===A.Completion&&delete this.H[o.invocationId];try{n(o)}catch(e){this.u.log(t.Error,`Stream callback threw error: ${x(e)}`)}}break}case A.Ping:break;case A.Close:{this.u.log(t.Information,\"Close message received from server.\");const e=o.error?new Error(\"Server returned an error on close: \"+o.error):void 0;!0===o.allowReconnect?this.connection.stop(e):this.tt=this.et(e);break}default:this.u.log(t.Warning,`Invalid message type: ${o.type}.`)}}this.K()}lt(e){let n,o;try{[o,n]=this.T.parseHandshakeResponse(e)}catch(e){const n=\"Error parsing handshake response: \"+e;this.u.log(t.Error,n);const o=new Error(n);throw this.J(o),o}if(n.error){const e=\"Server returned handshake error: \"+n.error;this.u.log(t.Error,e);const o=new Error(e);throw this.J(o),o}return this.u.log(t.Debug,\"Server handshake complete.\"),this.X(),o}Y(){this.connection.features.inherentKeepAlive||(this.C=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this.Z())}K(){if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this.dt=setTimeout((()=>this.serverTimeout()),this.serverTimeoutInMilliseconds),void 0!==this.ft))){let e=this.C-(new Date).getTime();e<0&&(e=0),this.ft=setTimeout((async()=>{if(this.q===N.Connected)try{await this.V(this.M)}catch{this.Z()}}),e)}}serverTimeout(){this.connection.stop(new Error(\"Server timeout elapsed without receiving a message from the server.\"))}ut(e){const n=this.D[e.target.toLowerCase()];if(n){try{n.forEach((t=>t.apply(this,e.arguments)))}catch(n){this.u.log(t.Error,`A callback for the method ${e.target.toLowerCase()} threw error '${n}'.`)}if(e.invocationId){const e=\"Server requested a response, which is not supported in this version of the client.\";this.u.log(t.Error,e),this.tt=this.et(new Error(e))}}else this.u.log(t.Warning,`No client method with the name '${e.target}' found.`)}_(e){this.u.log(t.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this.q}.`),this.B=this.B||e||new Error(\"The underlying connection was closed before the hub handshake could complete.\"),this.X&&this.X(),this.wt(e||new Error(\"Invocation canceled due to the underlying connection being closed.\")),this.G(),this.Z(),this.q===N.Disconnecting?this.nt(e):this.q===N.Connected&&this.P?this.gt(e):this.q===N.Connected&&this.nt(e)}nt(e){if(this.j){this.q=N.Disconnected,this.j=!1,v.isBrowser&&window.document.removeEventListener(\"freeze\",this.S);try{this.A.forEach((t=>t.apply(this,[e])))}catch(n){this.u.log(t.Error,`An onclose callback called with error '${e}' threw error '${n}'.`)}}}async gt(e){const n=Date.now();let o=0,r=void 0!==e?e:new Error(\"Attempting to reconnect due to a unknown error.\"),i=this.yt(o++,0,r);if(null===i)return this.u.log(t.Debug,\"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt.\"),void this.nt(e);if(this.q=N.Reconnecting,e?this.u.log(t.Information,`Connection reconnecting because of error '${e}'.`):this.u.log(t.Information,\"Connection reconnecting.\"),0!==this.R.length){try{this.R.forEach((t=>t.apply(this,[e])))}catch(n){this.u.log(t.Error,`An onreconnecting callback called with error '${e}' threw error '${n}'.`)}if(this.q!==N.Reconnecting)return void this.u.log(t.Debug,\"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.\")}for(;null!==i;){if(this.u.log(t.Information,`Reconnect attempt number ${o} will start in ${i} ms.`),await new Promise((e=>{this.st=setTimeout(e,i)})),this.st=void 0,this.q!==N.Reconnecting)return void this.u.log(t.Debug,\"Connection left the reconnecting state during reconnect delay. Done reconnecting.\");try{if(await this.F(),this.q=N.Connected,this.u.log(t.Information,\"HubConnection reconnected successfully.\"),0!==this.U.length)try{this.U.forEach((e=>e.apply(this,[this.connection.connectionId])))}catch(e){this.u.log(t.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${e}'.`)}return}catch(e){if(this.u.log(t.Information,`Reconnect attempt failed because of error '${e}'.`),this.q!==N.Reconnecting)return this.u.log(t.Debug,`Connection moved to the '${this.q}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(this.q===N.Disconnecting&&this.nt());r=e instanceof Error?e:new Error(e.toString()),i=this.yt(o++,Date.now()-n,r)}}this.u.log(t.Information,`Reconnect retries have been exhausted after ${Date.now()-n} ms and ${o} failed attempts. Connection disconnecting.`),this.nt()}yt(e,n,o){try{return this.P.nextRetryDelayInMilliseconds({elapsedMilliseconds:n,previousRetryCount:e,retryReason:o})}catch(o){return this.u.log(t.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${n}) threw error '${o}'.`),null}}wt(e){const n=this.H;this.H={},Object.keys(n).forEach((o=>{const r=n[o];try{r(null,e)}catch(n){this.u.log(t.Error,`Stream 'error' callback called with '${e}' threw error: ${x(n)}`)}}))}Z(){this.ft&&(clearTimeout(this.ft),this.ft=void 0)}G(){this.dt&&clearTimeout(this.dt)}at(e,t,n,o){if(n)return 0!==o.length?{arguments:t,streamIds:o,target:e,type:A.Invocation}:{arguments:t,target:e,type:A.Invocation};{const n=this.N;return this.N++,0!==o.length?{arguments:t,invocationId:n.toString(),streamIds:o,target:e,type:A.Invocation}:{arguments:t,invocationId:n.toString(),target:e,type:A.Invocation}}}ct(e,t){if(0!==e.length){t||(t=Promise.resolve());for(const n in e)e[n].subscribe({complete:()=>{t=t.then((()=>this.ht(this.bt(n))))},error:e=>{let o;o=e instanceof Error?e.message:e&&e.toString?e.toString():\"Unknown error\",t=t.then((()=>this.ht(this.bt(n,o))))},next:e=>{t=t.then((()=>this.ht(this.vt(n,e))))}})}}it(e){const t=[],n=[];for(let o=0;o<e.length;o++){const r=e[o];if(this.Et(r)){const i=this.N;this.N++,t[i]=r,n.push(i.toString()),e.splice(o,1)}}return[t,n]}Et(e){return e&&e.subscribe&&\"function\"==typeof e.subscribe}rt(e,t,n){const o=this.N;return this.N++,0!==n.length?{arguments:t,invocationId:o.toString(),streamIds:n,target:e,type:A.StreamInvocation}:{arguments:t,invocationId:o.toString(),target:e,type:A.StreamInvocation}}ot(e){return{invocationId:e,type:A.CancelInvocation}}vt(e,t){return{invocationId:e,item:t,type:A.StreamItem}}bt(e,t,n){return t?{error:t,invocationId:e,type:A.Completion}:{invocationId:e,result:n,type:A.Completion}}}const D=[0,2e3,1e4,3e4,null];class U{constructor(e){this.$t=void 0!==e?[...e,null]:D}nextRetryDelayInMilliseconds(e){return this.$t[e.previousRetryCount]}}class W{}var H,F;W.Authorization=\"Authorization\",W.Cookie=\"Cookie\",function(e){e[e.None=0]=\"None\",e[e.WebSockets=1]=\"WebSockets\",e[e.ServerSentEvents=2]=\"ServerSentEvents\",e[e.LongPolling=4]=\"LongPolling\"}(H||(H={})),function(e){e[e.Text=1]=\"Text\",e[e.Binary=2]=\"Binary\"}(F||(F={}));class B{constructor(){this.Ct=!1,this.onabort=null}abort(){this.Ct||(this.Ct=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this.Ct}}class z{constructor(e,t,n,o){this.$=e,this.St=t,this.u=n,this.kt=new B,this.Pt=o,this.Tt=!1,this.onreceive=null,this.onclose=null}get pollAborted(){return this.kt.aborted}async connect(e,n){if(w.isRequired(e,\"url\"),w.isRequired(n,\"transferFormat\"),w.isIn(n,F,\"transferFormat\"),this.It=e,this.u.log(t.Trace,\"(LongPolling transport) Connecting.\"),n===F.Binary&&\"undefined\"!=typeof XMLHttpRequest&&\"string\"!=typeof(new XMLHttpRequest).responseType)throw new Error(\"Binary protocols over XmlHttpRequest not implementing advanced features are not supported.\");const[o,i]=C(),s={[o]:i,...this.Pt.headers},a={abortSignal:this.kt.signal,headers:s,timeout:1e5,withCredentials:this.Pt.withCredentials};n===F.Binary&&(a.responseType=\"arraybuffer\");const c=await this._t();this.Ht(a,c);const l=`${e}&_=${Date.now()}`;this.u.log(t.Trace,`(LongPolling transport) polling: ${l}.`);const u=await this.$.get(l,a);200!==u.statusCode?(this.u.log(t.Error,`(LongPolling transport) Unexpected response code: ${u.statusCode}.`),this.Dt=new r(u.statusText||\"\",u.statusCode),this.Tt=!1):this.Tt=!0,this.xt=this.At(this.It,a)}async _t(){return this.St?await this.St():null}Ht(e,t){e.headers||(e.headers={}),t?e.headers[W.Authorization]=`Bearer ${t}`:e.headers[W.Authorization]&&delete e.headers[W.Authorization]}async At(e,n){try{for(;this.Tt;){const o=await this._t();this.Ht(n,o);try{const o=`${e}&_=${Date.now()}`;this.u.log(t.Trace,`(LongPolling transport) polling: ${o}.`);const i=await this.$.get(o,n);204===i.statusCode?(this.u.log(t.Information,\"(LongPolling transport) Poll terminated by server.\"),this.Tt=!1):200!==i.statusCode?(this.u.log(t.Error,`(LongPolling transport) Unexpected response code: ${i.statusCode}.`),this.Dt=new r(i.statusText||\"\",i.statusCode),this.Tt=!1):i.content?(this.u.log(t.Trace,`(LongPolling transport) data received. ${y(i.content,this.Pt.logMessageContent)}.`),this.onreceive&&this.onreceive(i.content)):this.u.log(t.Trace,\"(LongPolling transport) Poll timed out, reissuing.\")}catch(e){this.Tt?e instanceof i?this.u.log(t.Trace,\"(LongPolling transport) Poll timed out, reissuing.\"):(this.Dt=e,this.Tt=!1):this.u.log(t.Trace,`(LongPolling transport) Poll errored after shutdown: ${e.message}`)}}}finally{this.u.log(t.Trace,\"(LongPolling transport) Polling complete.\"),this.pollAborted||this.Rt()}}async send(e){return this.Tt?b(this.u,\"LongPolling\",this.$,this.It,this.St,e,this.Pt):Promise.reject(new Error(\"Cannot send until the transport is connected\"))}async stop(){this.u.log(t.Trace,\"(LongPolling transport) Stopping polling.\"),this.Tt=!1,this.kt.abort();try{await this.xt,this.u.log(t.Trace,`(LongPolling transport) sending DELETE request to ${this.It}.`);const e={},[n,o]=C();e[n]=o;const r={headers:{...e,...this.Pt.headers},timeout:this.Pt.timeout,withCredentials:this.Pt.withCredentials},i=await this._t();this.Ht(r,i),await this.$.delete(this.It,r),this.u.log(t.Trace,\"(LongPolling transport) DELETE request sent.\")}finally{this.u.log(t.Trace,\"(LongPolling transport) Stop finished.\"),this.Rt()}}Rt(){if(this.onclose){let e=\"(LongPolling transport) Firing onclose event.\";this.Dt&&(e+=\" Error: \"+this.Dt),this.u.log(t.Trace,e),this.onclose(this.Dt)}}}class _{constructor(e,t,n,o){this.$=e,this.St=t,this.u=n,this.Pt=o,this.onreceive=null,this.onclose=null}async connect(e,n){if(w.isRequired(e,\"url\"),w.isRequired(n,\"transferFormat\"),w.isIn(n,F,\"transferFormat\"),this.u.log(t.Trace,\"(SSE transport) Connecting.\"),this.It=e,this.St){const t=await this.St();t&&(e+=(e.indexOf(\"?\")<0?\"?\":\"&\")+`access_token=${encodeURIComponent(t)}`)}return new Promise(((o,r)=>{let i,s=!1;if(n===F.Text){if(v.isBrowser||v.isWebWorker)i=new this.Pt.EventSource(e,{withCredentials:this.Pt.withCredentials});else{const t=this.$.getCookieString(e),n={};n.Cookie=t;const[o,r]=C();n[o]=r,i=new this.Pt.EventSource(e,{withCredentials:this.Pt.withCredentials,headers:{...n,...this.Pt.headers}})}try{i.onmessage=e=>{if(this.onreceive)try{this.u.log(t.Trace,`(SSE transport) data received. ${y(e.data,this.Pt.logMessageContent)}.`),this.onreceive(e.data)}catch(e){return void this.Ut(e)}},i.onerror=e=>{s?this.Ut():r(new Error(\"EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled.\"))},i.onopen=()=>{this.u.log(t.Information,`SSE connected to ${this.It}`),this.Nt=i,s=!0,o()}}catch(e){return void r(e)}}else r(new Error(\"The Server-Sent Events transport only supports the 'Text' transfer format\"))}))}async send(e){return this.Nt?b(this.u,\"SSE\",this.$,this.It,this.St,e,this.Pt):Promise.reject(new Error(\"Cannot send until the transport is connected\"))}stop(){return this.Ut(),Promise.resolve()}Ut(e){this.Nt&&(this.Nt.close(),this.Nt=void 0,this.onclose&&this.onclose(e))}}class J{constructor(e,t,n,o,r,i){this.u=n,this.St=t,this.Lt=o,this.qt=r,this.$=e,this.onreceive=null,this.onclose=null,this.jt=i}async connect(e,n){if(w.isRequired(e,\"url\"),w.isRequired(n,\"transferFormat\"),w.isIn(n,F,\"transferFormat\"),this.u.log(t.Trace,\"(WebSockets transport) Connecting.\"),this.St){const t=await this.St();t&&(e+=(e.indexOf(\"?\")<0?\"?\":\"&\")+`access_token=${encodeURIComponent(t)}`)}return new Promise(((o,r)=>{let i;e=e.replace(/^http/,\"ws\");const s=this.$.getCookieString(e);let a=!1;if(v.isNode){const t={},[n,o]=C();t[n]=o,s&&(t[W.Cookie]=`${s}`),i=new this.qt(e,void 0,{headers:{...t,...this.jt}})}i||(i=new this.qt(e)),n===F.Binary&&(i.binaryType=\"arraybuffer\"),i.onopen=n=>{this.u.log(t.Information,`WebSocket connected to ${e}.`),this.Mt=i,a=!0,o()},i.onerror=e=>{let n=null;n=\"undefined\"!=typeof ErrorEvent&&e instanceof ErrorEvent?e.error:\"There was an error with the transport\",this.u.log(t.Information,`(WebSockets transport) ${n}.`)},i.onmessage=e=>{if(this.u.log(t.Trace,`(WebSockets transport) data received. ${y(e.data,this.Lt)}.`),this.onreceive)try{this.onreceive(e.data)}catch(e){return void this.Ut(e)}},i.onclose=e=>{if(a)this.Ut(e);else{let t=null;t=\"undefined\"!=typeof ErrorEvent&&e instanceof ErrorEvent?e.error:\"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.\",r(new Error(t))}}}))}send(e){return this.Mt&&this.Mt.readyState===this.qt.OPEN?(this.u.log(t.Trace,`(WebSockets transport) sending data. ${y(e,this.Lt)}.`),this.Mt.send(e),Promise.resolve()):Promise.reject(\"WebSocket is not in the OPEN state\")}stop(){return this.Mt&&this.Ut(void 0),Promise.resolve()}Ut(e){this.Mt&&(this.Mt.onclose=()=>{},this.Mt.onmessage=()=>{},this.Mt.onerror=()=>{},this.Mt.close(),this.Mt=void 0),this.u.log(t.Trace,\"(WebSockets transport) socket closed.\"),this.onclose&&(!this.Wt(e)||!1!==e.wasClean&&1e3===e.code?e instanceof Error?this.onclose(e):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||\"no reason given\"}).`)))}Wt(e){return e&&\"boolean\"==typeof e.wasClean&&\"number\"==typeof e.code}}class X{constructor(e,o={}){var r;if(this.Ot=()=>{},this.features={},this.Ft=1,w.isRequired(e,\"url\"),this.u=void 0===(r=o.logger)?new E(t.Information):null===r?g.instance:void 0!==r.log?r:new E(r),this.baseUrl=this.Bt(e),(o=o||{}).logMessageContent=void 0!==o.logMessageContent&&o.logMessageContent,\"boolean\"!=typeof o.withCredentials&&void 0!==o.withCredentials)throw new Error(\"withCredentials option was not a 'boolean' or 'undefined' value\");o.withCredentials=void 0===o.withCredentials||o.withCredentials,o.timeout=void 0===o.timeout?1e5:o.timeout;let i=null,s=null;if(v.isNode){i=n(350),s=n(350)}v.isNode||\"undefined\"==typeof WebSocket||o.WebSocket?v.isNode&&!o.WebSocket&&i&&(o.WebSocket=i):o.WebSocket=WebSocket,v.isNode||\"undefined\"==typeof EventSource||o.EventSource?v.isNode&&!o.EventSource&&void 0!==s&&(o.EventSource=s):o.EventSource=EventSource,this.$=o.httpClient||new L(this.u),this.q=\"Disconnected\",this.j=!1,this.Pt=o,this.onreceive=null,this.onclose=null}async start(e){if(e=e||F.Binary,w.isIn(e,F,\"transferFormat\"),this.u.log(t.Debug,`Starting connection with transfer format '${F[e]}'.`),\"Disconnected\"!==this.q)return Promise.reject(new Error(\"Cannot start an HttpConnection that is not in the 'Disconnected' state.\"));if(this.q=\"Connecting\",this.Xt=this.F(e),await this.Xt,\"Disconnecting\"===this.q){const e=\"Failed to start the HttpConnection before stop() was called.\";return this.u.log(t.Error,e),await this.tt,Promise.reject(new Error(e))}if(\"Connected\"!==this.q){const e=\"HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!\";return this.u.log(t.Error,e),Promise.reject(new Error(e))}this.j=!0}send(e){return\"Connected\"!==this.q?Promise.reject(new Error(\"Cannot send data if the connection is not in the 'Connected' State.\")):(this.Jt||(this.Jt=new V(this.transport)),this.Jt.send(e))}async stop(e){return\"Disconnected\"===this.q?(this.u.log(t.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):\"Disconnecting\"===this.q?(this.u.log(t.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this.tt):(this.q=\"Disconnecting\",this.tt=new Promise((e=>{this.Ot=e})),await this.et(e),void await this.tt)}async et(e){this.zt=e;try{await this.Xt}catch(e){}if(this.transport){try{await this.transport.stop()}catch(e){this.u.log(t.Error,`HttpConnection.transport.stop() threw error '${e}'.`),this.Vt()}this.transport=void 0}else this.u.log(t.Debug,\"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.\")}async F(e){let n=this.baseUrl;this.St=this.Pt.accessTokenFactory;try{if(this.Pt.skipNegotiation){if(this.Pt.transport!==H.WebSockets)throw new Error(\"Negotiation can only be skipped when using the WebSocket transport directly.\");this.transport=this.Gt(H.WebSockets),await this.Kt(n,e)}else{let t=null,o=0;do{if(t=await this.Qt(n),\"Disconnecting\"===this.q||\"Disconnected\"===this.q)throw new Error(\"The connection was stopped during negotiation.\");if(t.error)throw new Error(t.error);if(t.ProtocolVersion)throw new Error(\"Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.\");if(t.url&&(n=t.url),t.accessToken){const e=t.accessToken;this.St=()=>e}o++}while(t.url&&o<100);if(100===o&&t.url)throw new Error(\"Negotiate redirection limit exceeded.\");await this.Yt(n,this.Pt.transport,t,e)}this.transport instanceof z&&(this.features.inherentKeepAlive=!0),\"Connecting\"===this.q&&(this.u.log(t.Debug,\"The HttpConnection connected successfully.\"),this.q=\"Connected\")}catch(e){return this.u.log(t.Error,\"Failed to start the connection: \"+e),this.q=\"Disconnected\",this.transport=void 0,this.Ot(),Promise.reject(e)}}async Qt(e){const n={};if(this.St){const e=await this.St();e&&(n[W.Authorization]=`Bearer ${e}`)}const[o,i]=C();n[o]=i;const s=this.Zt(e);this.u.log(t.Debug,`Sending negotiation request: ${s}.`);try{const e=await this.$.post(s,{content:\"\",headers:{...n,...this.Pt.headers},timeout:this.Pt.timeout,withCredentials:this.Pt.withCredentials});if(200!==e.statusCode)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${e.statusCode}'`));const t=JSON.parse(e.content);return(!t.negotiateVersion||t.negotiateVersion<1)&&(t.connectionToken=t.connectionId),t}catch(e){let n=\"Failed to complete negotiation with the server: \"+e;return e instanceof r&&404===e.statusCode&&(n+=\" Either this is not a SignalR endpoint or there is a proxy blocking the connection.\"),this.u.log(t.Error,n),Promise.reject(new u(n))}}te(e,t){return t?e+(-1===e.indexOf(\"?\")?\"?\":\"&\")+`id=${t}`:e}async Yt(e,n,o,r){let i=this.te(e,o.connectionToken);if(this.ee(n))return this.u.log(t.Debug,\"Connection was provided an instance of ITransport, using that directly.\"),this.transport=n,await this.Kt(i,r),void(this.connectionId=o.connectionId);const s=[],a=o.availableTransports||[];let c=o;for(const o of a){const a=this.se(o,n,r);if(a instanceof Error)s.push(`${o.transport} failed:`),s.push(a);else if(this.ee(a)){if(this.transport=a,!c){try{c=await this.Qt(e)}catch(e){return Promise.reject(e)}i=this.te(e,c.connectionToken)}try{return await this.Kt(i,r),void(this.connectionId=c.connectionId)}catch(e){if(this.u.log(t.Error,`Failed to start the transport '${o.transport}': ${e}`),c=void 0,s.push(new l(`${o.transport} failed: ${e}`,H[o.transport])),\"Connecting\"!==this.q){const e=\"Failed to select transport before stop() was called.\";return this.u.log(t.Debug,e),Promise.reject(new Error(e))}}}}return s.length>0?Promise.reject(new d(`Unable to connect to the server with any of the available transports. ${s.join(\" \")}`,s)):Promise.reject(new Error(\"None of the transports supported by the client are supported by the server.\"))}Gt(e){switch(e){case H.WebSockets:if(!this.Pt.WebSocket)throw new Error(\"'WebSocket' is not supported in your environment.\");return new J(this.$,this.St,this.u,this.Pt.logMessageContent,this.Pt.WebSocket,this.Pt.headers||{});case H.ServerSentEvents:if(!this.Pt.EventSource)throw new Error(\"'EventSource' is not supported in your environment.\");return new _(this.$,this.St,this.u,this.Pt);case H.LongPolling:return new z(this.$,this.St,this.u,this.Pt);default:throw new Error(`Unknown transport: ${e}.`)}}Kt(e,t){return this.transport.onreceive=this.onreceive,this.transport.onclose=e=>this.Vt(e),this.transport.connect(e,t)}se(e,n,o){const r=H[e.transport];if(null==r)return this.u.log(t.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(!function(e,t){return!e||0!=(t&e)}(n,r))return this.u.log(t.Debug,`Skipping transport '${H[r]}' because it was disabled by the client.`),new c(`'${H[r]}' is disabled by the client.`,r);if(!(e.transferFormats.map((e=>F[e])).indexOf(o)>=0))return this.u.log(t.Debug,`Skipping transport '${H[r]}' because it does not support the requested transfer format '${F[o]}'.`),new Error(`'${H[r]}' does not support ${F[o]}.`);if(r===H.WebSockets&&!this.Pt.WebSocket||r===H.ServerSentEvents&&!this.Pt.EventSource)return this.u.log(t.Debug,`Skipping transport '${H[r]}' because it is not supported in your environment.'`),new a(`'${H[r]}' is not supported in your environment.`,r);this.u.log(t.Debug,`Selecting transport '${H[r]}'.`);try{return this.Gt(r)}catch(e){return e}}ee(e){return e&&\"object\"==typeof e&&\"connect\"in e}Vt(e){if(this.u.log(t.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this.q}.`),this.transport=void 0,e=this.zt||e,this.zt=void 0,\"Disconnected\"!==this.q){if(\"Connecting\"===this.q)throw this.u.log(t.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if(\"Disconnecting\"===this.q&&this.Ot(),e?this.u.log(t.Error,`Connection disconnected with error '${e}'.`):this.u.log(t.Information,\"Connection disconnected.\"),this.Jt&&(this.Jt.stop().catch((e=>{this.u.log(t.Error,`TransportSendQueue.stop() threw error '${e}'.`)})),this.Jt=void 0),this.connectionId=void 0,this.q=\"Disconnected\",this.j){this.j=!1;try{this.onclose&&this.onclose(e)}catch(n){this.u.log(t.Error,`HttpConnection.onclose(${e}) threw error '${n}'.`)}}}else this.u.log(t.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`)}Bt(e){if(0===e.lastIndexOf(\"https://\",0)||0===e.lastIndexOf(\"http://\",0))return e;if(!v.isBrowser)throw new Error(`Cannot resolve '${e}'.`);const n=window.document.createElement(\"a\");return n.href=e,this.u.log(t.Information,`Normalizing '${e}' to '${n.href}'.`),n.href}Zt(e){const t=e.indexOf(\"?\");let n=e.substring(0,-1===t?e.length:t);return\"/\"!==n[n.length-1]&&(n+=\"/\"),n+=\"negotiate\",n+=-1===t?\"\":e.substring(t),-1===n.indexOf(\"negotiateVersion\")&&(n+=-1===t?\"?\":\"&\",n+=\"negotiateVersion=\"+this.Ft),n}}class V{constructor(e){this.ne=e,this.ie=[],this.re=!0,this.oe=new G,this.he=new G,this.ce=this.ae()}send(e){return this.le(e),this.he||(this.he=new G),this.he.promise}stop(){return this.re=!1,this.oe.resolve(),this.ce}le(e){if(this.ie.length&&typeof this.ie[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this.ie} but was of type ${typeof e}`);this.ie.push(e),this.oe.resolve()}async ae(){for(;;){if(await this.oe.promise,!this.re){this.he&&this.he.reject(\"Connection stopped.\");break}this.oe=new G;const e=this.he;this.he=void 0;const t=\"string\"==typeof this.ie[0]?this.ie.join(\"\"):V.ue(this.ie);this.ie.length=0;try{await this.ne.send(t),e.resolve()}catch(t){e.reject(t)}}}static ue(e){const t=e.map((e=>e.byteLength)).reduce(((e,t)=>e+t)),n=new Uint8Array(t);let o=0;for(const t of e)n.set(new Uint8Array(t),o),o+=t.byteLength;return n.buffer}}class G{constructor(){this.promise=new Promise(((e,t)=>[this.de,this.fe]=[e,t]))}resolve(){this.de()}reject(e){this.fe(e)}}class Z{constructor(){this.name=\"json\",this.version=1,this.transferFormat=F.Text}parseMessages(e,n){if(\"string\"!=typeof e)throw new Error(\"Invalid input for JSON hub protocol. Expected a string.\");if(!e)return[];null===n&&(n=g.instance);const o=R.parse(e),r=[];for(const e of o){const o=JSON.parse(e);if(\"number\"!=typeof o.type)throw new Error(\"Invalid payload.\");switch(o.type){case A.Invocation:this.pe(o);break;case A.StreamItem:this.we(o);break;case A.Completion:this.ge(o);break;case A.Ping:case A.Close:break;default:n.log(t.Information,\"Unknown message type '\"+o.type+\"' ignored.\");continue}r.push(o)}return r}writeMessage(e){return R.write(JSON.stringify(e))}pe(e){this.ye(e.target,\"Invalid payload for Invocation message.\"),void 0!==e.invocationId&&this.ye(e.invocationId,\"Invalid payload for Invocation message.\")}we(e){if(this.ye(e.invocationId,\"Invalid payload for StreamItem message.\"),void 0===e.item)throw new Error(\"Invalid payload for StreamItem message.\")}ge(e){if(e.result&&e.error)throw new Error(\"Invalid payload for Completion message.\");!e.result&&e.error&&this.ye(e.error,\"Invalid payload for Completion message.\"),this.ye(e.invocationId,\"Invalid payload for Completion message.\")}ye(e,t){if(\"string\"!=typeof e||\"\"===e)throw new Error(t)}}const Y={trace:t.Trace,debug:t.Debug,info:t.Information,information:t.Information,warn:t.Warning,warning:t.Warning,error:t.Error,critical:t.Critical,none:t.None};class K{configureLogging(e){if(w.isRequired(e,\"logging\"),void 0!==e.log)this.logger=e;else if(\"string\"==typeof e){const t=function(e){const t=Y[e.toLowerCase()];if(void 0!==t)return t;throw new Error(`Unknown log level: ${e}`)}(e);this.logger=new E(t)}else this.logger=new E(e);return this}withUrl(e,t){return w.isRequired(e,\"url\"),w.isNotEmpty(e,\"url\"),this.url=e,this.httpConnectionOptions=\"object\"==typeof t?{...this.httpConnectionOptions,...t}:{...this.httpConnectionOptions,transport:t},this}withHubProtocol(e){return w.isRequired(e,\"protocol\"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error(\"A reconnectPolicy has already been set.\");return e?Array.isArray(e)?this.reconnectPolicy=new U(e):this.reconnectPolicy=e:this.reconnectPolicy=new U,this}build(){const e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error(\"The 'HubConnectionBuilder.withUrl' method must be called before building the connection.\");const t=new X(this.url,e);return M.create(t,this.logger||g.instance,this.protocol||new Z,this.reconnectPolicy)}}return Uint8Array.prototype.indexOf||Object.defineProperty(Uint8Array.prototype,\"indexOf\",{value:Array.prototype.indexOf,writable:!0}),Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,\"slice\",{value:function(e,t){return new Uint8Array(Array.prototype.slice.call(this,e,t))},writable:!0}),Uint8Array.prototype.forEach||Object.defineProperty(Uint8Array.prototype,\"forEach\",{value:Array.prototype.forEach,writable:!0}),o})()},e.exports=o()},700:function(e,t,n){var o,r;\"undefined\"!=typeof self&&self,o=function(){window.addEventListener(\"unhandledrejection\",(function(e){e.promise.weavy&&e.preventDefault()}));var e=function(e){var t,n=\"pending\",o=function(){return t};return o.promise=o.bind(o),o.state=function(){return n},(o.reset=function(){var r,i;return n=\"pending\",t=new Promise((function(e,t){r=function(){n=\"resolved\",e.apply(this,arguments)},i=function(){n=\"rejected\",t.apply(this,arguments)}})),t.weavy=!0,o.resolve=function(){return r.apply(t,arguments),o},o.reject=function(){return i.apply(t,arguments),o},\"function\"==typeof e&&e(r,i),o})(),o.then=function(){return(t=t.then.apply(t,arguments)).weavy=!0,o},o.catch=function(){return(t=t.catch.apply(t,arguments)).weavy=!0,o},o.finally=function(){return(t=t.finally.apply(t,arguments)).weavy=!0,o},o};return e.resolve=function(t){var n=e();return n.resolve(t),n},e.reject=function(t){var n=e();return n.reject(t),n},e},void 0===(r=\"function\"==typeof o?o.call(t,n,t,e):o)||(e.exports=r)},174:function(e,t){var n,o,r;\"undefined\"!=typeof self&&self,o=[],n=function(){var e={S4:function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},delegate:function(e,t){return function(n){var o=n.target;do{o.matches(e)&&t.apply(o,arguments)}while((o=o.parentNode)&&o!==n.currentTarget)}},debounce:function(e,t){let n,o=function(){const o=this,r=arguments;clearTimeout(n),n=setTimeout((()=>e.apply(o,r)),t)};return o.cancel=function(){clearTimeout(n)},o},throttle:function(e,t,n){let o,r,i=function(){const i=this,s=arguments;r?(clearTimeout(o),o=setTimeout((function(){Date.now()-r>=t&&(n?r=null:(e.apply(i,s),r=Date.now()))}),t-(Date.now()-r))):(e.apply(i,s),r=Date.now())};return i.cancel=function(){clearTimeout(o)},i},parseHTML:function(e){if(\"content\"in document.createElement(\"template\")){var t=document.createElement(\"template\");return t.innerHTML=e.trim(),t.content.children}var n=document.implementation.createHTMLDocument();return n.body.innerHTML=e.trim(),n.body.children},isVisible:function(e){return e.isConnected&&!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},isObject:function(e){return\"[object Object]\"===Object.prototype.toString.call(e)},isPlainObject:function(t){var n,o;return!1!==e.isObject(t)&&(void 0===(n=t.constructor)||(o=n.prototype,!1!==e.isObject(o)&&!1!==Object.prototype.hasOwnProperty.call(o,\"isPrototypeOf\")))},isJQuery:function(e){return!!(e&&e.jquery&&e.length)},assign:function(t,n,o){var r;t=t||{},n=n||{};var i={};for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r]);for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(o&&i[r]&&e.isPlainObject(i[r])&&e.isPlainObject(n[r])?i[r]=e.assign(i[r],n[r],o):i[r]=n[r]);return i},asArray:function(e){return e&&(Array.isArray(e)?e:[e])||[]},asElement:function(t){if(t){if(t instanceof HTMLElement)return t;if(\"string\"==typeof t)return 0===t.indexOf(\"<\")?e.parseHTML(t)[0]:document.querySelector(t);if(e.isJQuery(t))return console.warn(\"Weavy: providing jQuery elements is deprecated, please provide a HTMLElement or selector query instead.\"),t[0]}},eqString:function(e,t,n){return(n||\"string\"==typeof e&&\"string\"==typeof t)&&String(e).toUpperCase()===String(t).toUpperCase()},eqObjects:function(t,n,o){if(!e.isPlainObject(t)||!e.isPlainObject(n))return!1;var r=Object.getOwnPropertyNames(t),i=Object.getOwnPropertyNames(n);if(!o&&r.length!==i.length)return!1;for(var s=0;s<r.length;s++){var a=r[s],c=t[a],l=n[a];if(c!==l&&!e.eqJQuery(c,l)&&!e.eqObjects(c,l,o))return!1}return!0},eqJQuery:function(e,t){return e&&t&&e.jquery&&t.jquery&&e.jquery===t.jquery&&e.length===t.length&&e.length===e.filter(t).length},sanitizeJSON:function(e,t){if(!(t instanceof HTMLElement||t instanceof Node))return t},toSnakeCase:function(e){return e.length>0?e.replace(/([a-z\\d])([A-Z]+)/g,\"$1_$2\").replace(/-|\\s+/g,\"_\").toLowerCase():e},toCamelCase:function(e,t){return(e=t?e[0].toUpperCase()+e.substring(1):e[0].toLowerCase()+e.substring(1)).replace(/([-_][a-z])/gi,(function(e){return e.toUpperCase().replace(\"-\",\"\").replace(\"_\",\"\")}))},keysToCamelCase:function(t,n){if(e.isPlainObject(t)){const o={};return Object.keys(t).forEach((function(r){o[e.toCamelCase(r,n)]=e.keysToCamelCase(t[r],n)})),o}return Array.isArray(t)?t.map((function(t){return e.keysToCamelCase(t,n)})):t},keysToPascalCase:function(t){return e.keysToCamelCase(t,!0)},serializeObject:function(t,n){n=n||!1;var o={};return new FormData(t).forEach(((t,r)=>{var i=n?e.toSnakeCase(r):r;void 0!==o[i]?(o[i].push||(o[i]=[o[i]]),o[i].push(t||\"\")):o[i]=t||\"\"})),o},processJSONResponse:function(t){if(t){let n=(t.headers.has(\"content-type\")?t.headers.get(\"content-type\"):\"\").split(\";\")[0];if(t.ok){if(\"application/json\"===n)try{return t.json().then((function(t){return e.keysToCamelCase(t)})).catch((function(){return null}))}catch(e){return null}return t}if(n.match(/json$/i))try{return t.json().then((function(t){return e.keysToCamelCase(t)})).then((function(e){return Promise.reject(new Error(e.detail||e.title||e.message||t.statusText||e.status))}),(function(){return Promise.reject(new Error(t.statusText))}))}catch(e){}return Promise.reject(new Error(t.statusText))}}},t=[];e.storageAvailable=function(e){var n;if(!(e in t))try{n=window[e];var o=\"__storage_test__\";n.setItem(o,o),n.getItem(o)!==o&&(new Error(\"Mismatching storage items.\").name=\"StorageMismatchError\"),n.removeItem(o),t[e]=!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||\"StorageMismatchError\"===e.name||\"QuotaExceededError\"===e.name||\"NS_ERROR_DOM_QUOTA_REACHED\"===e.name)&&n&&0!==n.length}return!!t[e]};var n=new Map;return e.storeItem=function(t,o,r,i){var s=\"weavy_\"+window.location.hostname+\"_\"+t;i=i||\"localStorage\";try{if(o=r?JSON.stringify(o,e.sanitizeJSON):o,!e.storageAvailable(i))throw new Error;window[i].setItem(s,o)}catch(e){console.warning(\"Using fallback storage:\",t),n.set(s,o)}},e.retrieveItem=function(t,o,r){var i,s=\"weavy_\"+window.location.hostname+\"_\"+t;r=r||\"localStorage\";try{if(!e.storageAvailable(r))throw new Error;i=window[r].getItem(s)}catch(e){console.warning(\"Retrieving fallback storage:\",t),i=n.get(s)}if(i&&o)try{return JSON.parse(i)}catch(e){}return i},e.ready=function(e){\"loading\"!==document.readyState?e():document.addEventListener(\"DOMContentLoaded\",e,{once:!0})},e},void 0===(r=\"function\"==typeof n?n.apply(t,o):n)||(e.exports=r)},659:function(e,t){var n,o,r;\"undefined\"!=typeof self&&self,o=[],void 0===(r=\"function\"==typeof(n=function(){let e=(void 0!==self?self:window).wvy||{};return e.t=function(e){return(window.wvy&&null!==window.wvy.resources?window.wvy.resources[e]:e)||e},Object.defineProperty(e,\"settings\",{get:function(){return e.utils.retrieveItem(\"wvy.settings\",!0,\"sessionStorage\")},set:function(t){if(!e.utils.isPlainObject(t))throw new Error(\"Invalid settings object\");let n=e.utils.retrieveItem(\"wvy.settings\",!0,\"sessionStorage\");n&&(t=e.utils.assign(n,t)),e.utils.storeItem(\"wvy.settings\",t,!0,\"sessionStorage\")}}),e})?n.apply(t,o):n)||(e.exports=r)},253:(e,t,n)=>{\"use strict\";n.d(t,{default:()=>F});var o=n(174),r=n.n(o);const i=function(e){var t=this,n=[];function o(e,t,o,r,i,s){n.push({context:e,events:t,selector:o,handler:r,originalHandler:i,external:s})}function i(e,t,o,i,s,a){var c={context:e,events:t,selector:o,handler:i,originalHandler:s,external:a},l=n.filter((function(e){return r().eqObjects(c,e,!0)})).pop();return l&&l.handler}function s(e,t,o,i,s,a){var c={context:e,events:t,selector:o,handler:i,originalHandler:s,external:a},l=!1;return n.forEach((function(e,t){r().eqObjects(c,e,!0)&&(l=!0,n.splice(t,1))})),l}function a(e,t,o){var i=new CustomEvent(t,{cancelable:!0}),s=!1;return n.forEach((function(n){n.external||n.context!==e||n.events.split(\" \").forEach((function(e){if(e=0===e.indexOf(\"on:\")?e.split(\"on:\")[1]:e,t===e&&(!n.selector||r().eqObjects(n.selector,o,!0))){var a=n.handler(i,o);a?o=a:!1===a&&(s=!0)}}))})),!(s||i.cancelBubble||i.defaultPrevented)&&o}function c(n,o){var i,s,a,c,l=\"string\"==typeof o[0]&&o[0];return l?(c=\"function\"==typeof o[1]?o[1]:o[2],a=\"function\"==typeof o[1]?null:o[1],s=o[0],i=t===n?e:n):(c=\"function\"==typeof o[2]?o[2]:o[3],a=\"function\"==typeof o[2]?null:o[2],s=o[1],i=function(t){if(t){if(t.on&&\"function\"==typeof t.on)return t;var n=r().asElement(t);if(n)return n;if(t instanceof EventTarget)return t}return e}(i=o[0])),{context:i,events:s,selector:a,handler:c,external:!l}}this.on=function(e,t,n,i){var a=Array.from(arguments||[]),l=c(this,a),u=a[4];if(u){var d=function(){var e=Array.from(arguments||[]);try{l.handler.apply(this,e)}catch(e){try{l.handler()}catch(e){console.warn(\"Could not invoke one handler:\",e)}}s(l.context,l.events,l.selector,null,l.handler,l.external)};o(l.context,l.events,l.selector,d,l.handler,l.external),l.external&&(\"string\"==typeof l.selector||r().isPlainObject(l.selector)?\"function\"==typeof l.context.one?l.context.one(l.events,l.selector,d):console.warn(\"external .one() target does not support selectors\"):\"function\"==typeof l.context.one?l.context.one(l.events,d):l.context instanceof EventTarget?l.events.split(\" \").forEach((function(e){l.context.addEventListener(e,d,{once:!0})})):console.warn(\"external target does not have valid event listening\"))}else o(l.context,l.events,l.selector,l.handler,l.handler,l.external),l.external&&(\"string\"==typeof l.selector||r().isPlainObject(l.selector)?\"function\"==typeof l.context.one?l.context.on(l.events,l.selector,l.handler):console.warn(\"external .on() target does not support selectors\"):\"function\"==typeof l.context.on?l.context.on(l.events,l.handler):l.context instanceof EventTarget?l.events.split(\" \").forEach((function(e){l.context.addEventListener(e,l.handler)})):console.warn(\"external target does not have valid event listening\"))},this.one=function(e,t,n,o){this.on.call(this,e,t,n,o,!0)},this.off=function(e,t,n,o){var a=c(this,Array.from(arguments||[])),l=i(a.events,a.handler,a.context,a.selector),u=s(a.context,a.events,a.selector,l,a.handler,a.external);u&&l?a.external&&a.context&&(\"string\"==typeof a.selector||r().isPlainObject(a.selector)?\"function\"==typeof a.context.off?a.context.off(a.events,a.selector,l):console.warn(\"external target does not have valid event listening\"):\"function\"==typeof a.context.off?a.context.off(a.events,l):a.context instanceof EventTarget?a.events.split(\" \").forEach((function(e){a.context.removeEventListener(e,l)})):console.warn(\"external target does not have valid event listening\")):console.debug(\"event off: handler not found or already removed;\",a.events)},this.clear=function(){n.forEach((function(e){e.external&&e.context&&(\"string\"==typeof e.selector||r().isPlainObject(e.selector)?\"function\"==typeof e.context.off?e.context.off(e.events,e.selector,e.handler):console.warn(\"external target does not have valid event listening\"):\"function\"==typeof e.context.off?e.context.off(e.events,e.handler):e.context instanceof EventTarget?e.events.split(\" \").forEach((function(t){e.context.removeEventListener(t,e.handler)})):console.warn(\"external target does not have valid event listening\"))})),n.length=0},this.triggerEvent=function(t,n){var o=-1!==t.indexOf(\":\"),r=t.split(\":\")[0],i=function(e,t){for(var n=[],o=e;o!==t&&o.eventParent;)n.push(o),o=o.eventParent;return o===t?(n.push(t),n):[e,t]}(this,e),s=i.slice().reverse();this instanceof HTMLElement&&this.isConnected&&console.warn(\"Triggering event on DOM Node may cause unexpected bubbling:\",'\"'+t+'\"',\"<\"+this.nodeName.toLowerCase()+(this.id?' id=\"'+this.id+'\" />':\" />\"));var c,l,u=\"before:\"+(t=t.replace(\"on:\",\"\")),d=t,h=\"after:\"+t;if(n&&\"string\"==typeof n)try{n=JSON.parse(n)}catch(e){console.warn(\"Could not parse event data\")}if(o){var p=\"before\"===r||\"after\"===r?s:i;for(l=0;l<p.length;l++)if(!1===(n=(c=a(p[l],d,n))||!1===c?c:n))return n}else{for(l=0;l<s.length;l++)if(!1===(n=(c=a(s[l],u,n))||!1===c?c:n))return n;for(l=0;l<i.length;l++)if(!1===(n=(c=a(i[l],d,n))||!1===c?c:n))return n;for(l=0;l<s.length;l++)n=(c=a(s[l],h,n))||!1===c?c:n}return n}},s=[\"#36ace2\",\"#6599eb\",\"#646fed\",\"#773bde\",\"#bc4bce\",\"#d54487\",\"#de4b3b\",\"#e17637\",\"#e3a135\",\"#c9a018\",\"#a4c51b\",\"#cbbc15\",\"#7cd345\",\"#53c657\",\"#45d391\",\"#38dde0\"],a=\"#8c8c8c\";function c(e,t,n){return t?n?Function.prototype.bind.call(e,console,\"%c%s\",\"color: \"+n,t):Function.prototype.bind.call(e,console,\"%c%s\",\"color: \"+a,t):Function.prototype.bind.call(e,console,\"%cWeavy\",\"color: \"+a)}var l=function(e,t){if(!e)throw new Error(\"No context defined.\");e instanceof URL&&(e=e.pathname.split(\"/\").pop()||e.pathname||e.origin||e.hostname);var n=self.name?self.name+\":\":\"\",o=e.type||e.constructor&&e.constructor.name||\"\",r=e&&e.name?(o?\".\":\"\")+e.name:e.id?\"#\"+e.id:\"\",i=\"string\"==typeof e?n+e:n+o+r,u=l.defaults,d=Array.from(n).reduce((function(e,t){return e+t.charCodeAt(0)}),0)%s.length,h=s[d],p=a,g=function(){};Object.defineProperty(this,\"options\",{get:function(){return u},set:function(e){u=Object.assign({},l.defaults,u,e),p=!0===u?h:!1===u.color?a:\"string\"==typeof u.color?u.color:h;let t=!0===u||u.log,n=!0===u||u.info,o=!0===u||u.warn,r=!0===u||u.error;this.log=t?c(window.console.log,i,p):g,this.debug=t?c(window.console.debug,i,p):g,this.info=n?c(window.console.info,i,p):g,this.warn=o?c(window.console.warn,i,p):g,this.error=r?c(window.console.error,i,p):g,this.assert=r?Function.prototype.bind.call(console.assert,console):g,this.count=t?Function.prototype.bind.call(console.count,console):g,this.countReset=t?Function.prototype.bind.call(console.countReset,console):g,this.dir=t?Function.prototype.bind.call(console.dir,console):g,this.dirxml=t?Function.prototype.bind.call(console.dirxml,console):g,this.table=t?Function.prototype.bind.call(console.table,console):g,this.time=t?Function.prototype.bind.call(console.time,console):g,this.timeEnd=t?Function.prototype.bind.call(console.timeEnd,console):g,this.timeLog=t?Function.prototype.bind.call(console.timeLog,console):g,this.trace=t?Function.prototype.bind.call(console.trace,console):g,this.clear=Function.prototype.bind.call(console.clear,console),this.group=Function.prototype.bind.call(console.group,console),this.groupCollapsed=Function.prototype.bind.call(console.groupCollapsed,console),this.groupEnd=Function.prototype.bind.call(console.groupEnd,console)}}),this.options=t};l.defaults={color:!0,log:!1,info:!0,warn:!0,error:!0};const u=l;var d=n(700),h=n.n(d),p=n(659),g=n.n(p);const f=new function(e){var t=new u(\"WeavyPostal\"),n=this;this.timeout=e&&e.timeout||2e3;var o=[],i=[],s=new Set,a=new Map,c=new WeakMap,l=new WeakMap,d=new WeakMap,p=new WeakMap,f=new(h()),w=null,v=null,y=null,m=null,b=null,S=E(window.location.href);function E(e){var n=null;try{n=/^((?:https?:\\/\\/[^/]+)|(?:file:\\/\\/))\\/?/.exec(e)[1]}catch(e){t.error(\"Unable to resolve location origin. Make sure you are using http, https or file protocol and have a valid location URL.\")}return n}function C(e,t){var n=e.source===window&&e.origin===S,o=e.source===y&&e.origin===m;if(t||=c.has(e.source)&&e.origin===c.get(e.source),n||o||t){var s=!e.data.weavyId||!0===e.data.weavyId;t&&!e.data.windowName&&(e.data.windowName=l.get(e.source));var a=e.data.name;if(\"distribute\"===a){if(w)return;e.data.name=e.data.distributeName}i.forEach((function(t){var n=t.name===a||\"message\"===t.name,o=null===t.selector,i=t.selector===e.data.weavyId,c=r().isPlainObject(t.selector)&&r().eqObjects(t.selector,e.data,!0);n&&(s||o||i||c)&&(t.handler(e,e.data),t.once&&P(t.name,t.selector,t.handler))}))}}function I(e,t,n){\"function\"==typeof arguments[1]&&(n=arguments[1],t=null),i.push({name:e,handler:n,selector:t})}function P(e,t,n){\"function\"==typeof arguments[1]&&(n=arguments[1],t=null),i=i.filter((function(o){var i=e===o.name,s=n===o.handler,a=\"string\"==typeof t&&t===o.selector,c=r().isPlainObject(t)&&r().eqObjects(t,o.selector);return!(i&&s&&(null===t||a||c))}))}function T(e,t){if(a.has(t)){if(a.get(t).has(e)){var n=a.get(t).get(e);try{s.delete(n),l.delete(n),d.delete(n),c.delete(n)}catch(e){}}if(a.get(t).delete(e),0===a.get(t).size)try{a.delete(t)}catch(e){}}}function x(e,o,i){var s=new(h());null===i&&(i=void 0);var a=e===window.self,l=y&&y!==window&&y===e,u=a?E(window.location.href):l?m:c.get(e);return a||l||e&&u===p.get(e)?(o.weavyMessageId||(o.weavyMessageId=r().S4()+r().S4()),queueMicrotask((()=>{t.debug(\"whenPostMessage\",o.name,o.weavyMessageId);var r=setTimeout((function(){\"pending\"===s.state()&&s.reject(new Error(\"postMessage() receipt timed out: \"+o.weavyMessageId+\", \"+o.name))}),n.timeout||2e3);I(\"message-receipt\",{weavyId:o.weavyId,weavyMessageId:o.weavyMessageId},(function(){t.debug(\"message-receipt received\",o.weavyMessageId,o.name),clearTimeout(r),s.resolve()}));try{e.postMessage(o,u,i)}catch(e){s.reject(e)}}))):s.reject(new Error(\"postMessage() Invalid window origin: \"+u+\", \"+o.name)),s()}function k(e,n){if(\"object\"==typeof e&&e.name)return f().then((function(t){return t?h().resolve():(void 0===e.weavyId&&(e.weavyId=v),void 0===e.windowName&&(e.windowName=b),x(y,e,n))}));t.error(\"postToParent() Invalid message format\",e)}function O(){\"pending\"===f.state()&&(t.debug(\"Is leader\"),w=!0,f.resolve(w))}window.addEventListener(\"message\",(function(e){if(e.data.name&&void 0!==e.data.weavyId){if(e.data.weavyMessageId&&\"message-receipt\"!==e.data.name&&\"unready\"!==e.data.name){t.debug(\"sending message receipt\",e.data.weavyMessageId,e.data.name);try{e.source.postMessage({name:\"message-receipt\",weavyId:e.data.weavyId,weavyMessageId:e.data.weavyMessageId},e.origin)}catch(e){t.error(\"could not post back message-receipt to source\")}}switch(e.data.name){case\"register-child\":if(!y){if(d.has(e.source)||t.warn(\"register-child: contentwindow not pre-registered\"),c.get(e.source)!==e.origin)return void t.error(\"register-child: \"+l.get(e.source)+\" has invalid origin\",e.origin);try{var n=d.get(e.source),r=l.get(e.source);r&&e.source.postMessage({name:\"register-window\",windowName:r,weavyId:n||!0},e.origin)}catch(e){t.error(\"could not register frame window\",n,r,e)}}break;case\"register-window\":y||(m=e.origin,y=e.source,b=e.data.windowName,v=e.data.weavyId),window.addEventListener(\"unload\",(()=>{k({name:\"unready\"})})),t.debug(\"is not leader\"),w=!1,f.resolve(!1);var i=g().context&&g().context.statusCode,s=g().context&&g().context.statusDescription,u=document.querySelector(\".navbar-middle\"),h=u&&u.innerText;try{e.source.postMessage({name:\"ready\",windowName:e.data.windowName,weavyId:e.data.weavyId,location:window.location.href,title:h,statusCode:i,statusDescription:s},e.origin)}catch(e){t.error(\"register-window could not post back ready-message to source\",e)}g().whenLoaded&&g().whenLoaded.then((function(){k({name:\"load\"})})),o.length&&(o.forEach((function(e){C(e)})),o=[]);break;case\"ready\":a.has(e.data.weavyId)&&l.has(e.source)&&a.get(e.data.weavyId).get(l.get(e.source))&&(p.set(e.source,e.origin),C(e));break;case\"unready\":a.has(e.data.weavyId)&&C(e,!0);break;case\"reload\":t.debug(\"reload\",b,!!e.data.force),window.location.reload(e.data.force);break;default:e.source===window||y||a.size?C(e):o.push(e)}}})),this.on=I,this.one=function(e,t,n){\"function\"==typeof arguments[1]&&(n=arguments[1],t=null),i.push({name:e,handler:n,selector:t,once:!0})},this.off=P,this.registerContentWindow=function(e,n,o,r){try{if(!n)return void t.error(\"registerContentWindow() No valid contentWindow to register, must be a window and have a name.\")}catch(e){t.error(\"registerContentWindow() cannot access contentWindowName\")}e.self&&(e=e.self),o&&\"true\"!==o||(o=!0),a.has(o)||a.set(o,new Map),a.get(o).set(n,e),s.add(e),l.set(e,n),d.set(e,o),c.set(e,r)},this.unregisterContentWindow=T,this.unregisterAll=function(e){a.has(e)&&(a.get(e).forEach((function(t,n){T(n,e)})),a.get(e),a.delete(e))},this.postToFrame=function(e,n,o,r){if(\"object\"==typeof o&&o.name){var i;try{i=a.get(n).get(e)}catch(o){t.error(\"postToFrame() Window not registered\",n,e)}return o.weavyId=n,x(i,o,r)}t.error(\"postToFrame() Invalid message format\",o)},this.postToParent=k,this.postToSelf=function(e,n){if(\"object\"==typeof e&&e.name)return e.weavyId=e.weavyId||!0,x(window.self,e,n);t.error(\"postToSelf() Invalid message format\",e)},this.postToSource=function(e,n,o){if(e.source&&void 0!==e.data.weavyId){var r=e.source===window.self&&e.origin===S,i=e.source===y&&e.origin===m,s=c.has(e.source)&&e.origin===c.get(e.source);if(null===o&&(o=void 0),r||i||s){n.weavyId=e.data.weavyId;try{e.source.postMessage(n,e.origin,o)}catch(e){t.error(\"postToSource() Could not post message back to source\")}}}},this.postToChildren=function(e,n){\"object\"==typeof e&&e.name?(null===n&&(n=void 0),e.distributeName=e.name,e.name=\"distribute\",e.weavyId=e.weavyId||!0,s.forEach((function(o){if(c.get(o)===p.get(o))try{o.postMessage(e,c.get(o),n)}catch(e){t.warn(\"postToChildren() could not distribute message to \"+l.get(o))}}))):t.error(\"postToChildren() Invalid message format\",e)},this.whenLeader=function(){return f()},Object.defineProperty(this,\"isLeader\",{get:function(){return w}}),Object.defineProperty(this,\"parentWeavyId\",{get:function(){return v}}),Object.defineProperty(this,\"parentName\",{get:function(){return b}}),Object.defineProperty(this,\"parentOrigin\",{get:function(){return m}}),function(){var e=window.self.opener!==window.self&&window.self.opener||window.self.parent!==window.self&&window.self.parent;if(e){var n;try{if(!n){let e=g().config.corsOrigins;!e||1===e.length&&\"*\"===e[0]||(n=e,t.debug(\"Using CORS origin\"))}}catch(e){}try{n||(n=[e.location.origin])&&t.log(\"Using same-domain origin\")}catch(e){}if(n=n||[\"*\"],(n=Array.from(n).map((e=>-1!==e.indexOf(\"*\")?\"*\":e)).filter(((e,t,n)=>n.indexOf(e)===t)).sort(((e,t)=>e.indexOf(\"*\")-t.indexOf(\"*\")))).length>1){var o;if(\"ancestorOrigins\"in window.location&&(o=window.location.ancestorOrigins[0]),!o)try{o=e.location.origin}catch(e){}!o&&document.referrer&&new URL(document.referrer).origin!==window.location.origin&&(o=new URL(document.referrer).origin),o&&n.indexOf(o)>=0?n=[o]:t.warn(\"Frame registration may cause \"+(n.length-1)+\" origin error messages in the console due to multiple cors-origins configured.\")}n.length?(t.debug(\"Checking for parent\"),n.forEach((function(n){\"*\"===n&&t.warn(\"Using wildcard origin for registration.\");try{e.postMessage({name:\"register-child\",weavyId:!0},n)}catch(e){t.error(\"Error checking for parent\",e)}}))):t.warning(\"Could not find any parent with valid origin.\"),requestAnimationFrame((function(){window.setTimeout(O,n.length?2e3:1)}))}else O()}()};var w=n(763);const v=\".connection\",y=new u(\"realtime\");class m{connection;url;connectionEvents;constructor(e,t){this.url=e,this.tokenFactory=t instanceof Function?t:()=>t,this.connectionEvents=[]}async connect(){y.debug(\"connect\"),this.connection=(new w.HubConnectionBuilder).withUrl(new URL(\"/hubs/rtm\",this.url).toString(),{accessTokenFactory:this.tokenFactory}).withAutomaticReconnect().configureLogging(y.options.info?w.LogLevel.Information:w.LogLevel.Warning).build(),this.connection.onclose((e=>this.triggerHandler(\"close\",e))),this.connection.onreconnecting((e=>this.triggerHandler(\"reconnecting\",e))),this.connection.onreconnected((e=>this.triggerHandler(\"reconnected\",e))),await this.connection.start()}async subscribe(e){if(y.debug(\"subscribe\"),!this.connection)throw new Error(\"You must connect before subscribing!\");await this.connection.invoke(\"AddToGroup\",e)}async invoke(e,...t){if(y.debug(\"invoke:\",e),!this.connection)throw new Error(\"You must connect before invoking a mothod on the server!\");await this.connection.invoke(e,t)}on(e,t){if(y.debug(\"on\"),!this.connection)throw new Error(\"You must connect before binding events!\");e.endsWith(v)?this.connectionEvents.push({name:e,handler:t}):this.connection.on(e,t)}off(e,t){if(y.debug(\"off\"),!this.connection)throw new Error(\"You must connect before un-binding events!\");e.endsWith(v)?this.connectionEvents=this.connectionEvents.filter((n=>!(n.name===e&&n.handler===t))):this.connection.off(e,t)}triggerHandler(e,...t){e=e.endsWith(v)?e:e+v;let n=new CustomEvent(e,{cancelable:!1});y.debug(\"triggerHandler\",e),this.connectionEvents.forEach((o=>{o.name===e&&o.handler(n,...t)}))}async disconnect(){this.connection&&await this.connection.stop()}async disconnectAndConnect(){if(!this.connection||this.connection.state===w.HubConnectionState.Disconnected)throw new Error(\"No active connection to disconnect and connect.\");await this.connection.stop(),await this.connection.start()}}if(\"customElements\"in window)try{window.customElements.define(\"weavy-root\",HTMLElement.prototype),window.customElements.define(\"weavy-container\",HTMLElement.prototype)}catch(e){}var b=\"weavy, weavy-root { display: contents; }\";if(\"CSS\"in window&&CSS.supports(\"display\",\"contents\")||(b=\"weavy, weavy-root { display: flex; position: absolute; top: 0; left: 0; right: 0; bottom: 0; pointer-events: none; }\"),document.adoptedStyleSheets){var S=new CSSStyleSheet;S.replaceSync(b),document.adoptedStyleSheets=Array.prototype.concat.call(document.adoptedStyleSheets,[S])}else{var E=document.createElement(\"style\");E.type=\"text/css\",E.styleSheet?E.styleSheet.cssText=b:E.appendChild(document.createTextNode(b)),document.getElementsByTagName(\"head\")[0].appendChild(E)}class C{static supportsShadowDOM=!!HTMLElement.prototype.attachShadow;static supportsConstructableStylesheets=\"adoptedStyleSheets\"in document;id;#e;parent;section;root;dom;container;#t;#n;#o;constructor(e,t,n,o){if(this.#t=e,this.#e=e.removeId(n),this.id=e.getId(n),this.parent=r().asElement(t),!this.parent)throw new Error(\"No parent container defined\"+this.id);this.eventParent=o,this.on=e.events.on.bind(this),this.one=e.events.one.bind(this),this.off=e.events.off.bind(this),this.triggerEvent=e.events.triggerEvent.bind(this),this.section=document.createElement(\"weavy\"),this.section.id=this.id,this.root=document.createElement(\"weavy-root\"),this.root.setAttribute(\"data-version\",e.version),this.container=document.createElement(\"weavy-container\"),this.container.className=\"weavy-container\",this.container.id=e.getId(\"weavy-container-\"+this.#e),this.#n=[],this.#o=\"\";for(let t of document.styleSheets)try{if(t instanceof CSSStyleSheet&&t.cssRules&&t.cssRules[0]instanceof CSSNamespaceRule&&\"weavy\"===t.cssRules[0].prefix)if(e.debug(\"CSS: found external stylesheet\"),C.supportsConstructableStylesheets){var i=new CSSStyleSheet;for(let e of t.cssRules)i.insertRule(e.cssText,i.cssRules.length);this.#n.push({stylesheet:i})}else this.#n.push({stylesheet:t})}catch(t){e.warn(\"Error reading stylesheet:\",t)}this.triggerEvent(\"before:root-create\",this),this.parent.appendChild(this.section),this.section.appendChild(this.root),C.supportsShadowDOM?(\"open\"===e.options.shadowMode&&e.warn(\"Using ShadowDOM in open mode\",this.id),this.dom=this.root.attachShadow({mode:e.options.shadowMode||\"closed\"})):this.dom=this.root,this.dom.appendChild(this.container),this.addStyles(e.options),this.triggerEvent(\"on:root-create\",this),this.#n.length||this.#o||o&&o!==e||e.error(\"CSS: No styles provided! Provide a stylesheet using the weavy namespace or add styles in options.\"),queueMicrotask((()=>this.triggerEvent(\"after:root-create\",this)))}addStyles(e){if(e?.css&&(this.#t.debug(\"CSS: adding custom css\"),this.#r(e.css)),e?.stylesheet){r().asArray(e.stylesheet).forEach((e=>{this.#t.debug(\"CSS: fetching stylesheet\");var t=new URL(e,window.location.href),n=new(h());let o={whenCss:n};this.#n.push(o),fetch(t).then((e=>{let t=(e.headers.has(\"content-type\")?e.headers.get(\"content-type\"):\"\").split(\";\")[0];if(e.ok&&\"text/css\"===t)return e.text().then((e=>{if(C.supportsConstructableStylesheets){var t=new CSSStyleSheet;t.replaceSync(e),o.stylesheet=t}else this.#r(e);n.resolve()}));n.reject(new Error(\"Error fetching stylesheet\"))}))}))}return this.#i(),Promise.all(this.#n.map((e=>e.whenCss)))}getStyles(e){return Promise.all(this.#n.map((e=>e.whenCss))).then((()=>this.#n.reduce(((t,n)=>n.stylesheet?t+Array.from(n.stylesheet.cssRules).reduce(((t,n)=>e&&n instanceof CSSNamespaceRule?t:t+=n.cssText),\"\"):t),\"\")+\"\\n\"+this.#o))}#i(){this.triggerEvent(\"before:root-styles\"),!!this.#n.find((e=>\"pending\"===e.whenCss?.state()))?Promise.all(this.#n.map((e=>e.whenCss))).then((()=>{this.#s(),this.#a(),this.triggerEvent(\"on:root-styles\"),this.triggerEvent(\"after:root-styles\")})):(this.#s(),this.#a(),this.triggerEvent(\"on:root-styles\"),this.triggerEvent(\"after:root-styles\"))}#a(){if(this.#o){this.#t.debug(\"CSS: setting custom css stylesheet\");let t=document.createElement(\"style\");if(t.appendChild(document.createTextNode(this.#o)),C.supportsShadowDOM)this.dom.appendChild(t);else{var e=this.#t.getId(\"weavy-styles\");document.getElementById(e)||(t.id=e,document.getElementsByTagName(\"head\")[0].appendChild(t))}}}#s(){let e=this.#n.map((e=>e.stylesheet)).filter((e=>e));C.supportsConstructableStylesheets?(this.#t.debug(\"CSS: setting adopted stylesheets\",this.dom),this.dom.adoptedStyleSheets=[...this.dom.adoptedStyleSheets,...e]):(this.#t.debug(\"CSS: cloning stylesheets\",this.dom),e.forEach((e=>{if(e.ownerNode){let t=e.href&&!this.dom.querySelector(\"link[rel='stylesheet'][href='\"+e.href+\"']\"),n=!e.href&&!Array.from(this.dom.querySelectorAll(\"style\")).filter((t=>{try{let n=t.cssRules.length===e.cssRules.length,o=!t.cssRules.length||t.cssRules[0].cssText===e.cssRules[0].cssText,r=!t.cssRules.length||t.cssRules[t.cssRule-1].cssText===e.cssRules[t.cssRule-1].cssText;return n&&o&&r}catch(e){return!1}})).length;if(t||n)try{this.dom.appendChild(e.ownerNode.cloneNode(!0))}catch(e){this.weavy.error(\"Could not clone stylesheet\",e)}}else this.#t.warn(\"Could not add stylesheet: No valid ownerNode\")})))}#r(e){if(e)if(C.supportsConstructableStylesheets){var t=new CSSStyleSheet;t.replaceSync(e),this.#n.push({stylesheet:t})}else this.#o+=e+\"\\n\"}remove(){this.triggerEvent(\"before:remove-root\",this),this.section&&(this.section.remove(),this.section=null),this.triggerEvent(\"on:remove-root\",this),this.triggerEvent(\"after:remove-root\",this)}}const I=C;var P=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),T=function(e,t,n,o,i,s){if(o){var a=[],c=h().resolve();e.debug(\"creating panel\",o);var l=e.getId(\"panel-container-\"+o);r().isPlainObject(s)||(s={});var u=function(t){var n=document.createElement(\"iframe\");return n.className=\"weavy-panel-frame\",n.id=e.getId(\"panel-\"+o),n.name=e.getId(\"panel-\"+o),n.allowFullscreen=1,n.dataset.weavyId=e.getId(),t&&(n.dataset.src=new URL(t,e.url).href),n},d=this;d.panelId=o,d.attributes=s,d.node=document.createElement(\"div\"),d.node.className=\"weavy-panel\",s.className&&d.node.classList.add(...s.className.split(\" \")),d.node.id=l,d.node.dataset.id=o,s.title&&(d.node.dataset.title=s.title),d.frame=u(i),d.node.appendChild(d.frame),d.node.frame=d.frame,d.eventParent=n,d.on=e.events.on.bind(d),d.one=e.events.one.bind(d),d.off=e.events.off.bind(d),d.triggerEvent=e.events.triggerEvent.bind(d),d.frame.dataset.src&&(d.location=new URL(d.frame.dataset.src,e.url).href),s.type&&(d.node.dataset.type=s.type),void 0!==s.persistent&&(d.node.dataset.persistent=String(s.persistent)),void 0!==s.preload&&(d.node.dataset.preload=String(s.preload));try{e.debug(\"Appending panel\",o),n.node.appendChild(d.node),t.set(o,d)}catch(t){e.error(\"Could not append panel\",o)}var p=!1,w=!1,v=!1,y=!1;d.loadingStarted=function(e){e&&(v=!1),y=!0,S(d)},d.loadingFinished=function(){v=!0,y=!1,S(d)},d.on(\"panel-loading\",(function(e,t){requestAnimationFrame((()=>{t.isLoading?d.node.classList.add(\"weavy-loading\"):d.node.classList.remove(\"weavy-loading\"),t.isLoaded?d.node.classList.add(\"weavy-loaded\"):d.node.classList.remove(\"weavy-loaded\")}))})),Object.defineProperty(d,\"isOpen\",{get:function(){return d.node.classList.contains(\"weavy-open\")}}),Object.defineProperty(d,\"isLoading\",{get:function(){return y}}),Object.defineProperty(d,\"isRegistered\",{get:function(){return p}}),Object.defineProperty(d,\"isReady\",{get:function(){return w}}),Object.defineProperty(d,\"isLoaded\",{get:function(){return v}}),d.whenReady=new(h());var m=function(t,n){w=!0,d.triggerEvent(\"before:panel-ready\",{panelId:o});var r=d.location,i=d.statusCode,s=!n.statusCode||200===n.statusCode;d.location=new URL(n.location,e.url).href,d.statusCode=n.statusCode,\"string\"==typeof n.title&&n.title&&(d.node.dataset.title=n.title),d.loadingFinished(),i===n.statusCode||s||e.warn(n.location+\" \"+n.statusCode+\" \"+n.statusDescription);var a=r&&r!==d.location,c=i!==d.statusCode,l=d.location===d.frame.dataset.src&&!d.isOpen;d.isOpen&&(a||c)&&(a&&s&&!l?d.stateChangedAt=Date.now():s&&!l||(d.stateChangedAt=null),e.history.addState(\"replace\")),d.triggerEvent(\"on:panel-ready\",{panelId:o}),d.whenReady.resolve(d),d.triggerEvent(\"after:panel-ready\",{panelId:o})},b=function(){d.triggerEvent(\"before:panel-unready\",{panelId:o}),w=!1,d.loadingStarted(!0),d.whenReady.reset(),d.triggerEvent(\"on:panel-unready\",{panelId:o}),d.triggerEvent(\"after:panel-unready\",{panelId:o})};e.on(f,\"ready\",{weavyId:e.getId(),windowName:d.frame.name},m),e.on(f,\"unready\",{weavyId:e.getId(),windowName:d.frame.name},b);return d.whenLoaded=new(h()),e.on(f,\"load\",{weavyId:e.getId(),windowName:d.frame.name},(function(){d.whenLoaded.resolve(d)})),d.open=function(t,o){return e.whenReady().then((function(){if(e.log(\"openPanel\",d.panelId+(t?\" \"+t:\"\"),o?\"no history\":\"with history\"),!d.node.dataset.persistent&&!e.authentication.isAuthorized())return Promise.reject(new Error(\"Unauthorized, can't open panel \"+d.panelId));var r=d.triggerEvent(\"panel-open\",{panelId:d.panelId,destination:t,panels:n});return!1!==r&&r.panelId===d.panelId?(d.node.classList.add(\"weavy-open\"),window.requestAnimationFrame((()=>d.node.classList.add(\"weavy-transition\"))),d.load(r.destination,null,null,null,o)):Promise.reject(new Error(\"Prevented open \"+d.panelId))}))},d.toggle=function(t){return e.whenReady().then((function(){e.info(\"toggling panel\",d.panelId);var n=d.isOpen;return d.triggerEvent(\"panel-toggle\",{panelId:d.panelId,closed:n}),n?d.close():d.open(\"string\"==typeof t?t:null)}))},d.close=function(t,o){return e.whenReady().then((function(){if(d.isOpen){e.info(\"closePanel\",d.panelId,!0===o?\"no event\":\"\",!0===t?\"no history\":\"\"),c.reset();var r=[];d.node.classList.remove(\"weavy-open\",\"weavy-transition\"),!0!==o&&(d.triggerEvent(\"panel-close\",{panelId:d.panelId,panels:n}),!0!==t&&(d.stateChangedAt=Date.now(),e.history.addState())),r.push(d.postMessage({name:\"close\"}).catch((()=>{e.warn(\"Unable to close panel\",d.panelId)}))),r.push(e.whenTimeout(250)),Promise.all(r).then((()=>d.postMessage({name:\"closed\"}))).then((()=>{c.resolve()}))}return c()}))},d.load=function(t,n,r,i,s){return e.whenReady().then((function(){var a=d.frame;if(e.log(\"panel.load\",t,i),t)t=new URL(t,e.url).href,d.location=t,d.isReady?(e.log(\"panel is ready load\"),i&&d.loadingStarted(!0),d.postMessage({name:\"turbo-visit\",url:t,data:n,method:r,action:\"replace\"})):(e.log(\"panel not ready load\"),d.loadingStarted(i),function(t,n,o,r){e.whenReady().then((function(){if(r=String(r||\"get\").toLowerCase(),t){var i=n;if(\"get\"===r&&o&&(i=-1===i.indexOf(\"?\")?i+\"?\"+o:i+\"&\"+o),t.src!==i){if(t.src=i,\"get\"===r)return void e.debug(\"sendToFrame using src\")}else if(t.src&&\"get\"===r)return e.debug(\"sendToFrame using window.open\"),void window.open(i,t.name);e.debug(\"sendToFrame using form\");var s=document.createElement(\"form\");s.action=n,s.method=r,s.target=t.name,o&&(o=o.replace(/\\+/g,\"%20\")),(o&&o.split(\"&\")||[]).forEach((function(e){var t=e.split(\"=\"),n=decodeURIComponent(t[0]),o=decodeURIComponent(t[1]),r=document.createElement(\"input\");r.type=\"hidden\",r.name=n,r.value=o,s.appendChild(r)})),e.nodes.container.appendChild(s),s.submit(),s.remove()}}))}(a,t,n,r));else if(d.isLoaded||d.isLoading){if(!d.isLoaded&&!d.isLoading)return Promise.resolve();d.postMessage({name:\"show\"})}else e.debug(\"panels:\",o,\"predefined loading\"),d.loadingStarted(!0),a.setAttribute(\"src\",a.dataset.src);return!0!==s&&(d.stateChangedAt=Date.now(),e.debug(\"panels: adding history state\",o,d.location),e.history.addState()),d.whenLoaded()}))},d.preload=function(){var t=function(){d.isLoading||d.isLoaded||(e.debug(\"preloading panel:\",o),d.load(null,null,null,null,!0))};return window.requestIdleCallback?window.requestIdleCallback(t):\"complete\"===document.readyState?t():e.one(document,\"load\",t),d.whenLoaded()},d.reload=function(){return e.whenReady().then((function(){d.isLoading=!0,d.postMessage({name:\"reload\"}),d.triggerEvent(\"panel-reload\",{panelId:o})}))},d.reset=function(){return e.whenReady().then((function(){var t=d.frame;if(t){e.log(\"resetting panel\",o);var n=u(t.dataset.src||t.src);p=!1,w=!1,v=!1,y=!1,d.location=null,d.statusCode=null,d.whenReady.reset(),d.whenLoaded.reset();var r=d.isOpen;try{f.unregisterContentWindow(t.name,e.getId())}catch(n){e.error(\"Could not unregister window id\",t.name,n)}return d.node.removeChild(t),d.node.appendChild(n),d.frame=n,d.triggerEvent(\"panel-reset\",{panelId:o}),r?d.load(null,null,null,null,!0):Promise.resolve()}return Promise.resolve()}))},d.getState=function(){return e.debug(\"getPanelState\",o),e.history.getStateFromPanel(o)},d.setState=function(t){if(t&&t.panelId===o)if(new URL(t.location,e.url).origin===e.url.origin){if(t.title&&(d.node.dataset.title=t.title),!t.statusCode||200===t.statusCode){if(t.isOpen===d.isOpen&&t.location===d.location||(d.stateChangedAt=t.changedAt),t.isOpen){var n=t.location!==d.location?t.location:null;return d.isOpen?d.open(n,!0):d.open(t.location,!0)}return d.close(!0)}e.warn(\"setState: Invalid url http status.\",o)}else e.warn(\"setState: Invalid url origin.\",o,new URL(t.location,e.url).origin);else e.warn(\"setState: State not valid.\",o)},e.on(f,\"message\",{weavyId:e.getId(),windowName:d.frame.name},((e,t)=>d.triggerEvent(\"message\",r().assign(t,{panelId:o})))),d.postMessage=function(t,n){return d.whenReady().then((function(){var o=d.frame;return o?o.isConnected?o&&f?f.postToFrame(o.name,e.getId(),t,n):Promise.reject():Promise.reject(new Error(\"Panel frame \"+d.panelId+\" is not connected to the DOM.\")):Promise.reject(new Error(\"No valid panel frame for \"+d.panelId+\".\"))}))},d.remove=function(r,i){var s=function(i){if(!d.node.dataset.persistent||r){if(d.isOpen)return d.id=e.getId(\"weavy-panel-removed-\"+o),e.whenTimeout(0).then((function(){return d.close(i).then((function(){return d.remove(r,i)}))}));e.off(f,\"ready\",{weavyId:e.getId(),windowName:d.frame.name},m),e.off(f,\"unready\",{weavyId:e.getId(),windowName:d.frame.name},b);try{f.unregisterContentWindow(d.frame.name,e.getId())}catch(t){e.error(\"Could not unregister window id\",d.frame.name,t)}return d.node.remove(),t.delete(o),n.triggerEvent(\"panel-removed\",{panelId:o}),Promise.resolve()}};return r?s(i):e.whenReady().then((function(){return s(i)}))},e.on(f,\"request:reset\",{weavyId:e.getId(),windowName:d.frame.name},(function(){d.reset()})),e.on(f,\"request:close\",{weavyId:e.getId(),windowName:d.frame.name},(function(){d.close()})),d.node.appendChild(function(t,n){var o=document.createElement(\"div\");if(o.className=\"weavy-controls\",n.controls&&(!0===n.controls||n.controls.close)){var r=document.createElement(\"div\");r.className=\"weavy-icon\"+(\"string\"==typeof n.controls.close?\" \"+n.controls.close:\"\"),r.title=g().t(\"Close\"),r.innerHTML='<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z\" /></svg>',e.on(r,\"click\",t.close.bind(t)),o.appendChild(r)}return o}.call(e,d,s)),n.triggerEvent(\"panel-added\",{panel:d,panelId:o,url:i,attributes:s}),d}function S(t){t.isLoading?(!function(t){if(!t.isRegistered){try{f.registerContentWindow(t.frame.contentWindow.self,t.frame.name,e.getId(),e.url.origin)}catch(n){e.error(\"Could not register window id\",t.frame.name,n)}p=!0}}(t),a[o]=e.whenTimeout(3e4),a[o].then((function(){y=!1,S(t)}))):a[o]&&(a[o].cancel(),delete a[o]),t.triggerEvent(\"panel-loading\",{panelId:o,isLoading:t.isLoading,isLoaded:t.isLoaded})}e.error(\"new WeavyPanel() is missing panelId\")},x=function(e){var t=new Map,n=new Map;function o(t){e.debug(\"closing panels\");var o=[];return n.forEach((function(e){o.push(e.close(t))})),Promise.all(o)}function r(o){e.debug(\"clearing\"+(o?\" all\":\"\")+\" panels\",n.size);var r=[];n.forEach((function(e){r.push(e.remove(o,!0))}));var i=Promise.all(r).then((function(){t.forEach((function(n,r){!function(n,o){n=n||\"global\";var r=t.get(n);if(o){try{r.node.remove()}catch(t){e.warn(\"Could not remove panels container\")}t.delete(n),delete r.node,e.log(\"Panels container removed\",n)}}(r,o)}))}));return i}function i(){e.debug(\"resetting panels\");var t=[];return n.forEach((function(e){t.push(e.reset(!0))})),Promise.all(t)}function s(o){if(P)return Promise.resolve();var r=this;return\"whenReady\"in e?e.whenReady().then((function(){var i,a=(i=r instanceof HTMLElement&&r.dataset.containerId?t.get(r.dataset.containerId).panels:Array.from(n.values())).filter((function(e){return e.isLoading}));if(a.length)return Promise.all(a.map((function(e){return e.whenLoaded()}))).then((function(){return s.call(r,o)}));var c=i.filter((function(e){return!(\"true\"!==e.node.dataset.preload&&\"placeholder\"!==e.node.dataset.preload||e.isLoading||e.isLoaded)}));if(c.length)return Promise.all(c.map((function(e){return e.preload()}))).then((function(){return s.call(r,o)}));if(o){var l=i.filter((function(e){return\"false\"!==e.node.dataset.preload&&!e.isLoading&&!e.isLoaded}));if(l.length)return l[0].preload().then((function(){return e.whenTimeout(1500).then((function(){return s.call(r,!0)}))}))}return e.debug(\"preload done\"),Promise.resolve()})):Promise.resolve()}var a=function(){!1!==e.options.preload&&e.whenTimeout(5e3).then((function(){s()}))};e.on(\"load\",a),e.on(\"clear-user signed-out\",(function(){o(!0)})),e.on(\"after:clear-user after:signed-out\",(function(){i()})),e.on(\"user-error\",(function(){r()})),e.on(\"destroy\",(function(t,n){e.off(\"load\",a),n.whenAllDestroyed.push(r(!0))})),this.clearPanels=r,this.closePanels=o,this.createContainer=function(o){o=o||\"global\";var r=e.getId(\"panels-\"+o),i={containerId:o},s=document.createElement(\"div\");return s.id=r,s.className=\"weavy-panels\",s.dataset.containerId=o,i.node=s,i.addPanel=function(t,o,r){return new T(e,n,i,t,o,r)},i.on=e.events.on.bind(i),i.one=e.events.one.bind(i),i.off=e.events.off.bind(i),i.triggerEvent=e.events.triggerEvent.bind(i),t.set(o,i),i},this.getContainer=function(e){return t.get(e||\"global\")},this.getPanel=function(e){return n.get(e)},this.getCurrentPanels=function(){return Array.from(n.values())},this.preload=s,this.resetPanels=i};x.defaults={controls:{close:!1}};const k=x;const O=function(e){var t=this,n=new Map,o={modal:\"weavy-modal\",preview:\"weavy-dark\",overlay:\"weavy-floating\"},i={preview:/^(.*)(\\/attachments\\/[0-9]+\\/?)(.+)?$/,content:/^(.*)(\\/content\\/[0-9]+\\/?)(.+)?$/};function s(){e.debug(\"sorting overlays\",Array.from(n.values()).filter((e=>e.isOpen)).reverse()),Array.from(n.values()).filter((e=>e.isOpen)).reverse().forEach(((e,t)=>{e.node&&(e.node.style.transform=\"translateZ(-\"+t+\"rem)\")}))}function a(t){if(e.log(\"overlay panels focus\",t?.panelId,Array.from(n.values())),t=t||l())try{t.frame.contentWindow.focus()}catch(e){t.frame.focus()}}function c(e){e.isOpen?e.loadingStarted(!0):e.reset()}function l(){return Array.from(n.values()).filter((e=>e.isOpen)).pop()}function u(e){var t=l();if(t)return 27===e?(t.close(),!0):(t.postMessage({name:\"key:trigger\",which:e}),!0)}this.overlay=function(t){t=r().assign(t),e.log(\"get overlay\",t);let i=t.overlayId||t.type||\"overlay\",a=n.get(i);if(a)t.title?a.node.dataset.title=t.title:delete a.node.dataset.title;else{let r=new URL(t.url,e.url);t.type&&(t.className=o[t.type]+(t.className?\" \"+t.className:\"\")),a=e.nodes.panels.overlays.addPanel(\"overlay:\"+i,r,t),a.on(\"before:panel-open\",(function(){!function(t){var o=n.get(t);o&&(e.debug(\"preview panels moveToFront\",t),n.delete(t),n.set(t,o),requestAnimationFrame(s))}(i)})),a.on(\"panel-ready root-styles\",(()=>e.root.getStyles().then((e=>{a.postMessage({name:\"styles\",id:i,css:e,className:t.className})})))),n.set(i,a)}return a},e.on(f,\"overlay-open\",e.getId(),(function(n,o){var r=new URL(o.url,e.url).href;o.url=r,o.overlayId=o.overlayId||o.type||o.weavyMessageId||\"overlay\",e.log(\"overlay-open\",o);var i,s=t.overlay(o,!0);s.location&&s.location!==o.url&&c(s),i=o.url,s.open(i).then(a)})),e.on(\"before:build\",(function(){e.nodes.panels.overlays||(e.nodes.panels.overlays=e.panels.createContainer(),e.nodes.panels.overlays.node.classList.add(\"weavy-overlays\"),e.nodes.global.appendChild(e.nodes.panels.overlays.node))})),e.on(\"after:panel-close\",(function(t,o){if(o.panels===e.nodes.panels.overlays){var r=o.panelId.split(\"overlay:\")[1];n.get(r);e.log(\"overlay panel after:close\",o.panelId,r),s(),a()}})),this.open=function(n){return e.whenLoaded().then((function(){var e=n.url,o=n.target||\"overlay\";\"overlay\"===o&&i.preview.test(e)&&(o=\"preview\");var r=t.overlay({type:o,url:e});return n.source&&n.source!==r.frame.name&&c(r),r.open(e).then(a)}))},this.openState=function(n){return e.whenLoaded().then((function(){let e=r().assign(n.attributes,{title:n.title});t.overlay(e).setState(n).then(a)}))},this.closeAll=function(t){return e.whenLoaded().then((function(){let e=Array.from(n.values()).map((e=>e.close(t)));return Promise.all(e)}))},e.on(f,\"key:press\",e.getId(),(function(t,n){e.log(\"bouncing key\",n.which,l()?.panelId),u(n.which)})),e.on(document,\"keyup\",(function(e){u(e.which)&&e.stopImmediatePropagation()}))};const j=function(e){var t=this;function n(t){var n=new(h());return t.target?(e.log(\"navigation: opening overlay \"+t.url),e.overlays.open(t).then((e=>{n.resolve(e)}))):t.app&&(t.app.id||t.app.appId)?e.whenLoaded().then((function(){var o=e.app(t.app.id||t.app.appId);o?(e.overlays.closeAll(!0),o.open(t.url).then((function(e){n.resolve(e)}))):(e.info(\"navigation: requested app was not found\"),n.reject())})):(e.warn(\"navigation: url was not resolved to an app\"),n.reject()),n()}t.open=function(t){var o=r().isPlainObject(t)&&t.url,i=!t.app&&!t.target&&(\"string\"==typeof t&&t||o),s=String(i||o);if(s.includes(\"wvy:\")){e.log(\"checking weavy url\");var a=s,c=new URL(s,e.url),l=c&&c.hash&&c.hash.replace(/^#/,\"\");return l&&l.startsWith(\"wvy:\")&&(a=c.hash.replace(/^#/,\"\").split(\",\")),e.history.open(a)}if(i){var u;e.log(\"checking url using click\");try{u=new URL(s,e.url)}catch(t){e.error(\"Could not parse navigation request url\")}if(u){let t=u.pathname.split(\"/\").filter((e=>e));if(\"dropin\"===t[0]){let[o,r,i]=t.slice(1);return r=parseInt(r),e.debug(\"Opening url parsed navigation request\",o,r,i),n({url:s,app:{appId:r}})}}}else if(o)return e.log(\"open navigation request\",t),n(t);return h().reject()},e.on(f,\"navigation-open\",e.getId(),(function(n){let o=\"string\"==typeof n.data.route?{url:n.data.route}:n.data.route;e.log(\"navigation-open\",o),o=e.triggerEvent(\"before:navigate\",o),o.source=n.data.windowName,!1!==o&&(e.info(\"navigate: trying internal auto navigation\"),t.open(o).catch((function(){o=e.triggerEvent(\"on:navigate\",o),!1!==o&&e.triggerEvent(\"after:navigate\",o)})))}))};const L=function(e){var t=this;function n(e,t){return t&&(t.forEach((function(t){var n=!1;e=e.map((function(e){var o=!e.weavyId&&!t.weavyId||e.weavyId===t.weavyId,r=e.panelId===t.panelId;return o&&r?(n=!0,t):e})),n||e.push(t)})),e.sort((function(e,t){var n=e.isOpen-t.isOpen,o=(e.changedAt||0)-(t.changedAt||0);return n||o}))),e}function o(){var n=t.getCurrentState();e.debug(\"history: set current state\",n),t.setBrowserState(n,\"replace\")}t.openUri=function(e){var n=t.getStateFromUri(e);return n&&n.panels.length?t.openState(n):h().reject()},t.getStateFromUri=function(t){t=r().asArray(t);var n=[];return t.forEach((function(t){if(\"string\"==typeof t&&0===t.indexOf(\"wvy://\")){var o=/^wvy:\\/\\/([^@/]*)@?([^/]*)(.*)$/.exec(t);if(o&&o.length){var r=o[1],i=o[2],s=\"panel-\"+r+\"__\"+(i||e.getId()),a=o[3];e.debug(\"history: parsed wvy url\",i,r),n.push({id:s,panelId:r,isOpen:!0,location:a,statusCode:200,weavyId:i,weavyUri:t,changedAt:Date.now()})}}})),{panels:n}},t.getStateFromPanel=function(t){var n=e.panels.getPanel(t);if(n){var o=e.options.id&&e.getId(),r=\"wvy://\"+(e.options.id?e.getId(t).replace(\"__\",\"@\"):t)+(n.location&&new URL(n.location,e.url).pathname||\"\");return{id:n.node.id,panelId:t,isOpen:n.isOpen,location:n.location,statusCode:n.statusCode,title:n.node.dataset.title,weavyId:o,weavyUri:r,changedAt:n.stateChangedAt,attributes:n.attributes}}e.warn(\"history: getStateFromPanel; Panel not found \"+t)},t.getCurrentState=function(){return{panels:e.panels.getCurrentPanels().map((function(e){return e.getState()})).sort((function(e,t){var n=e.isOpen-t.isOpen,o=(e.changedAt||0)-(t.changedAt||0);return n||o}))}},t.getBrowserState=function(){return window.history.state&&window.history.state.weavy},t.setBrowserState=function(t,o,r){if(t){e.debug(\"history: \"+(o||\"setting\")+\" browser state\");var i=window.history.state||{};i.weavy=i.weavy||{},i.weavy.panels=n(i.weavy.panels||[],t.panels),r=r&&String(r)||window.location.href;try{\"replace\"===o?window.history.replaceState(i,null,r):window.history.pushState(i,null,r)}catch(t){e.warn(\"history: Could not push history state.\",t)}}},t.addState=function(o,r){r=r||t.getCurrentState();var i=window.history.state||{},s=i.weavy=i.weavy||{},a={state:r,action:o||\"push\",url:window.location.href,globalState:s};return!1!==(a=e.triggerEvent(\"before:history\",a))&&(a.globalState.panels=n(a.globalState.panels||[],a.state.panels),!1!==(a=e.triggerEvent(\"on:history\",a))&&(e.debug(\"history: \"+a.action+\" history state\"),t.setBrowserState(a.state,a.action,a.url),e.triggerEvent(\"after:history\",a))),a.state},t.openState=function(t){return t&&t&&t.panels&&Array.isArray(t.panels)?e.whenReady().then((function(){return e.debug(\"history: opening state\"),e.overlays.closeAll(!0),Promise.all(t.panels.map((function(t){if(!t.weavyId&&!e.options.id||t.weavyId===e.getId()){if(!t.panelId.startsWith(\"overlay:\")){var n=e.panels.getPanel(t.panelId);return n?(e.debug(\"history: setting panel state\",t.panelId),n.setState(t)):h().resolve()}e.overlays.openState(t)}})))})):h().reject(\"Error opening state\")},e.on(window,\"popstate\",(function(){var n=t.getBrowserState();n&&(e.debug(\"history: popstate\",n),t.openState(n))})),e.whenInitialized().then((function(){var n=t.getBrowserState();n&&(e.debug(\"history: load state\",n),t.openState(n)),e.whenLoaded().then(e.whenTimeout(1)).then(o)}))},R=new Map;class ${static getAuthentication(e){var t=!1,n=(e=e&&String(e))&&/^(https?:\\/(\\/[^/]+)+)\\/?$/.exec(e);if(n&&(t=window.location.origin===n[1],e=n[1]),e=(t?\"\":e)||\"\",R.has(e))return R.get(e);var o=new A(e);return R.set(e,o),o}static removeAuthentication(e){e=e&&String(e)||\"\";try{var t=R.get(e);t&&t.destroy&&t.destroy(),R.delete(e)}catch(t){console.error(\"Could not remove authentication\",e,t)}}static get default(){if(R.has(\"\"))return R.get(\"\");var e=$.getAuthentication();return r().ready((function(){setTimeout((function(){1===R.size&&e.init()}),1)})),e}static get on(){return $.default.on}static get sso(){return $.default.sso}}class A{constructor(e){var t=!1,n=new u(\"WeavyAuthentication\");n.debug(\"create new weavy authentication\",e),(e=e&&String(e)||window.location.origin+(g().config&&g().config.applicationPath||\"/\"))&&(e=/\\/$/.test(e)?e.slice(0,-1):e);var o=new i(this);this.on=o.on,this.one=o.one,this.off=o.off;var s,a,c=null,l=null,d=new(h()),p=new(h()),w=!1,v=!1,y=new(h()),m=!1;function b(e){return e?e.id&&-1!==e.id||!1:c&&c.id&&-1!==c.id||!1}function S(e){n.debug(\"configuring jwt\"),s=null,a=e}function E(e){return new Promise((function(t,n){if(!s||e)if(e&&(s=null),void 0!==a)if(\"string\"==typeof a)t(s=a);else if(\"function\"==typeof a){var o=a();\"function\"==typeof o.then?o.then((function(e){t(s=e)}),(function(e){n(\"failed to get token from the jwt factory promise:\",e)})):\"string\"==typeof o?t(s=o):n(\"failed to get token from the jwt factory function\")}else n(\"jwt option must be a string or a function that returns a promise\");else t(!1);else t(s)}))}function C(){n.debug(\"clearing jwt\"),s=null,a=null}function I(e,t){e&&e.id?(c&&e&&c.id!==e.id&&n.debug(\"setUser\",e.id,t),c=e,g().context&&(g().context.user=e.id),l=!0,b(e)?p.resolve():(\"pending\"!==p.state()&&p.reset(),m=!1,y.resolve()),d.resolve(e)):(c=null,g().context&&(g().context.user=null),l=!1,p.reset())}function P(e,t){g().alert&&!v&&g().alert.alert(t||\"info\",e,null,\"wvy-authentication-alert\")}function T(e,t){var r=\"updated\",i=' <a href=\"#\" onclick=\"location.reload(); return false;\">'+g().t(\"Reload\")+\"</a>\";e&&e.id?(l&&(b()?e&&-1===e.id?(n.info(\"signed-out\"),P(g().t(\"You have been signed out.\")+i),r=\"signed-out\"):e&&e.id!==c.id&&(n.info(\"changed-user\"),P(g().t(\"The signed in user has changed.\")+i),r=\"changed-user\"):e&&-1!==e.id&&(n.info(\"signed-in\",t),g()&&g().context&&g().context.user&&e.id!==g().context.user&&P(g().t(\"You have signed in.\")+i),r=\"signed-in\")),I(e,t||\"processUser()\"),o.triggerEvent(\"user\",{state:r,authorized:b(e),user:e})):(I(null,t||\"processUser()\"),o.triggerEvent(\"clear-user\"),!1!==o.triggerEvent(\"user\",{state:\"user-error\",authorized:!1,user:e})&&f.whenLeader().then((function(e){e&&P(g().t(\"Authentication error.\")+i,\"danger\")})));w=!1}function x(t){return w||(w=!0,f.whenLeader().then((function(o){if(o){n.debug(\"whenLeader => updateUserState\"+(void 0!==a?\":jwt\":\":cookie\"),t),\"pending\"!==d.state()&&d.reset(),\"pending\"!==p.state()&&p.reset();var i=new URL(\"/dropin/client/user\",e),s={method:\"POST\",mode:\"cors\",cache:\"reload\",credentials:\"include\",headers:{\"Content-Type\":\"application/json\",\"X-Requested-With\":\"XMLHttpRequest\"},redirect:\"manual\",referrerPolicy:\"no-referrer-when-downgrade\"};E().then((function(e){if(void 0!==a){if(\"string\"!=typeof e)return Promise.reject(new Error(\"Provided JWT token is invalid.\"));s.body=JSON.stringify({jwt:e})}window.fetch(i.toString(),s).then((function(e){return 401===e.status&&void 0!==a?(n.warn(\"JWT failed, trying again\"),E(!0).then((function(e){return s.body=JSON.stringify({jwt:e}),window.fetch(i.toString(),s)}))):e})).then(r().processJSONResponse).then((function(e){n.debug(\"updateUserState ajax -> processing user\"),T(e,\"updateUserState,\"+t)}),(function(){n.warn(\"updateUserState request fail\"),n.debug(\"updateUserState ajax fetch fail -> processing user\"),T({id:null},\"updateUserState,\"+t)}))}))}else f.postToParent({name:\"request:user\",weavyId:\"wvy.authentication\",baseUrl:e})}))),d()}function k(){var t=new(h()),i=new URL(\"/dropin/client/login\",e);if(m)return y.then((function(){return k()}));\"pending\"!==y.state()&&y.reset(),n.debug(\"validating jwt\"),o.triggerEvent(\"signing-in\");var s={method:\"POST\",mode:\"cors\",cache:\"reload\",credentials:\"include\",headers:{\"Content-Type\":\"application/json\",\"X-Requested-With\":\"XMLHttpRequest\"},redirect:\"manual\",referrerPolicy:\"no-referrer-when-downgrade\"};return E().then((function(e){return\"string\"!=typeof e?Promise.reject(new Error(\"Provided JWT token is invalid.\")):(s.headers.Authorization=\"Bearer \"+e,window.fetch(i.toString(),s).then((function(e){return 401===e.status?(n.warn(\"JWT failed, trying again\"),E(!0).then((function(e){return s.headers.Authorization=\"Bearer \"+e,window.fetch(i.toString(),s)}))):e})).then(r().processJSONResponse).then((function(e){return T(e),t.resolve(e)})).catch((function(e){n.error(\"sign in with JWT token failed.\",e.message),o.triggerEvent(\"authentication-error\",{method:\"jwt\",status:401,message:e.message}),T({id:null})})))}))}window.addEventListener(\"beforeunload\",(function(){v=!0})),window.addEventListener(\"turbolinks:request-start\",(function(){v=!0})),window.addEventListener(\"turbolinks:load\",(function(){v=!1,c&&g().context&&g().context.user&&c.id!==g().context.user&&T({id:g().context.user},\"turbolinks:load/wvy.context.user\")}));var O=function(t){\"request:user\"===t.data.name&&d.then((function(){f.postToSource(t,{name:\"user\",user:c,weavyId:\"wvy.authentication\",baseUrl:e})}))},j=function(e){var t=e.data;\"user\"===t.name&&(n.debug(\"parentMessage user -> processing user\"),T(t.user,\"parentMessage:user\"))};this.init=function(o){return(null===l||o&&o!==a)&&(\"string\"!=typeof o&&\"function\"!=typeof o||S(o),void 0!==a?(n.debug(\"authenticate by jwt\"),f.whenLeader().finally((function(){return k()}))):g().context&&g().context.user?I({id:g().context.user},\"init/wvy.context.user\"):x(\"authenticate()\")),t||(t=!0,f.on(\"message\",{weavyId:\"wvy.authentication\",baseUrl:e},O),f.on(\"distribute\",{weavyId:\"wvy.authentication\",baseUrl:e},j),n.debug(\"init\",e||window.name?\"\":\"self\")),d()},this.isAuthorized=b,this.isAuthenticated=function(){return!0===l},this.isInitialized=function(){return!0===t},this.isProvided=function(){return!!a},this.whenAuthenticated=function(){return d()},this.whenAuthorized=function(){return p()},this.signIn=function(e){return\"string\"!=typeof e&&\"function\"!=typeof e||S(e),\"pending\"!==d.state()&&d.reset(),\"pending\"!==p.state()&&p.reset(),f.whenLeader().finally((function(){return k()})),d()},this.signOut=function(t){var r=new URL(\"/dropin/client/logout\",e);return m=!0,t&&C(),o.triggerEvent(\"clear-user\"),window.fetch(r.toString(),{method:\"POST\",mode:\"cors\",cache:\"reload\",credentials:\"include\",headers:{\"X-Requested-With\":\"XMLHttpRequest\"},redirect:\"manual\",referrerPolicy:\"no-referrer-when-downgrade\"}).catch((function(){n.warn(\"signOut request fail\")})).finally((function(){n.debug(\"signout ajax -> processing user\"),T({id:-1},\"signOut()\")})),y()},this.setJwt=S,this.getJwt=E,this.clearJwt=C,this.updateUserState=x,this.user=function(){return c},this.destroy=function(){l=null,c=null,s=null,a=null,f.off(\"message\",{weavyId:\"wvy.authentication\",baseUrl:e},O),f.off(\"distribute\",{weavyId:\"wvy.authentication\",baseUrl:e},j),o.clear(),t=!1}}}const N=$;var q=function(e,t,n){e.debug(\"new WeavyApp\",t);var o=this;o.container=null,o.root=null,o.panel=null,o.url=null,o.id=null,o.appId=null,o.name=null,o.type=null,o.autoOpen=null,o.weavy=e,o.options=t,o.data=n,o.eventParent=e,o.on=e.events.on.bind(o),o.one=e.events.one.bind(o),o.off=e.events.off.bind(o),o.triggerEvent=function(t,n){return n=r().assign(n,{app:o}),e.events.triggerEvent.call(o,t,n)},Object.defineProperty(this,\"isOpen\",{get:function(){return!!o.panel&&o.panel.isOpen}}),o.isInitialized=!1,o.isBuilt=!1,Object.defineProperty(this,\"isLoaded\",{get:function(){return!!o.panel&&o.panel.isReady}}),o.whenInitialized=new(h()),o.whenBuilt=new(h()),o.whenLoaded=new(h()),o.configure=function(e,t){e&&\"object\"==typeof e&&(o.options=r().assign(o.options,e,!0)),t&&\"object\"==typeof t&&(o.data=t),o.options&&\"object\"==typeof o.options&&(null!==o.autoOpen&&null!==o.container||(o.autoOpen=o.options&&void 0!==o.options.open?o.options.open:!o.group||!1,o.container=o.options.container),null===o.id&&o.options.id&&(o.id=o.options.id),null===o.name&&o.options.name&&(o.name=o.options.name),null===o.type&&o.options.type&&(o.type=o.options.type)),o.data&&\"object\"==typeof o.data&&(!o.id&&o.data.id&&(o.id=o.data.id),null===o.appId&&o.data.appId&&(o.appId=o.data.appId),o.url=o.data.url,o.isInitialized=!0,o.triggerEvent(\"app-init\"),o.whenInitialized.resolve(o),!o.isBuilt&&o.weavy.isBuilt&&o.build())},o.fetchOrCreate=function(t){if(t&&\"object\"==typeof t&&(o.options=t),o.options&&\"object\"==typeof o.options){var n=new URL(\"/dropin/client/app\",e.url);e.ajax(n,o.options,\"POST\").then((function(e){o.data=e,o.configure.call(o)})).catch((function(e){o.weavy.error(\"WeavyApp.fetchOrCreate()\",e.message),o.whenInitialized.reject(e)}))}else o.whenInitialized.reject(new Error(\"WeavyApp.fetchOrCreate() requires options\"));return o.whenInitialized()},o.build=function(){return e.authentication.whenAuthorized().then((function(){if(o.options&&o.data){let a=\"app-root-\"+(o.options.group||o.id);var n=o.root??=e.getRoot(a);if(!n&&o.container)try{o.root=n=e.createRoot(o.container,a,o),n.apps=new Set,n.container.panels=e.panels.createContainer(\"app-container-\"+o.id),n.container.panels.eventParent=o,n.container.appendChild(n.container.panels.node)}catch(t){e.warn(\"could not create app in container\",{id:o.id},t)}if(!o.isBuilt&&n){o.isBuilt=!0,e.debug(\"Building app\",o.id);var i=\"app-\"+o.id,s=!(!o.options||void 0===o.options.controls)&&o.options.controls;let a=o.root.addStyles(o.options);o.panel=n.container.panels.addPanel(i,o.url,{controls:s}),n.apps.add(o),o.panel.on(\"panel-open\",((e,t)=>o.triggerEvent(\"app-open\",t))),o.panel.on(\"panel-toggle\",((e,t)=>o.triggerEvent(\"app-toggle\",t))),o.panel.on(\"panel-close\",((e,t)=>o.triggerEvent(\"app-close\",t))),o.on(\"before:message\",((e,t)=>{if(t.panelId===i)return r().assign(t,{app:o})})),o.panel.whenReady().then((()=>{o.triggerEvent(\"app-load\"),o.whenLoaded.resolve(o)})),o.on(\"panel-ready root-styles\",(()=>o.root.getStyles().then((e=>{o.postMessage({name:\"styles\",id:o.id,css:e,className:t.className})})))),a.then((e=>{o.triggerEvent(\"app-build\"),o.whenBuilt.resolve(o)}))}}})),o.whenBuilt()},e.on(\"build\",o.build.bind(o)),o.whenBuilt().then((function(){e.whenReady().then((function(){o.autoOpen&&!o.isOpen&&o.open.call(o,null,!0)}))})),e.on(\"after:signed-in\",(function(){e.whenReady().then((function(){o.autoOpen&&!o.isOpen&&o.open.call(o,null,!0)}))})),o.configure()};q.prototype.open=function(e,t){var n=this,o=n.weavy;return Promise.all([n.whenBuilt(),o.whenInitialized()]).then((function(){var r=[n.panel.open(e,t)];let i=Array.from(n.root&&n.root.apps||[]);return i.length>1&&i.forEach((function(e){e!==n&&r.push(e.panel.close(!0))})),Promise.all(r).catch((function(e){o.warn(\"Could not open app\",n.id,e)}))}),(function(e){o.warn(\"Could not open app\",n.id,e)}))},q.prototype.close=function(){var e=this;return e.autoOpen=!1,e.whenBuilt().then((function(){return e.panel.close()}))},q.prototype.toggle=function(e){var t=this,n=t.weavy;return t.whenBuilt().then((function(){var o=[t.panel.toggle(e)];let r=Array.from(t.root&&t.root.apps||[]);return!t.isOpen&&r.length>1&&r.forEach((function(e){e!==t&&o.push(e.panel.close(!0,!0))})),Promise.all(o).catch((function(e){n.warn(\"Could not toggle app\",t.id,e)}))}))},q.prototype.reset=function(){var e=this,t=e.weavy;return Promise.all([e.whenBuilt(),t.whenReady()]).then((function(){return e.panel.reset()}))},q.prototype.remove=function(){var e=this,t=this.weavy;t.debug(\"Removing app\",e.id);var n=(e.panel?e.panel.remove(null,!0):Promise.resolve()).then((function(){if(\"getRoot\"in t){let o=\"app-root-\"+(e.options.group||e.id);var n=t.getRoot(o);n&&0===n.apps.size&&n.remove()}}));return e.root.apps.remove(e),t.apps=t.apps.filter((function(t){return!t.match(e)})),n},q.prototype.postMessage=function(e,t){var n=this;return n.whenBuilt().then((function(){return n.panel.postMessage(e,t)}))},q.prototype.match=function(e){if(e){if(e.id&&this.id)return r().eqString(e.id,this.id);if(e.appId&&this.appId)return e.appId===this.appId}return!1},q.prototype.addStyles=function(e){var t,n;return\"string\"==typeof e?t=e:r().isPlainObject(e)&&(t=e.css,n=e.stylesheet),this.whenBuilt.then((()=>this.root.addStyles({css:t,stylesheet:n})))},q.getAppSelector=e=>{var t=\"string\"==typeof e,n=Number.isInteger(e),o=r().isPlainObject(e),i=o&&e||t&&{id:e}||n&&{appId:e};return i||(\"id\"in e?i={id:e.id}:\"appId\"in e&&(i={appId:e.appId})),{isId:t,isAppId:n,isConfig:o,selector:i}};const M=q;console.info(\"weavy.js\");const D=\"/dropin/client/init\",U=/(?<major>\\d+)\\.(?<minor>\\d+)\\.(?<patch>\\d+)(?:[-](?<prerelease>[^+]+))?(?:[+](?<build>\\S+))?/;var W=[],H=function(){var e=this;for(var t in e.options=r().assign(H.defaults),arguments)arguments[t]&&\"object\"==typeof arguments[t]&&(e.options=r().assign(e.options,arguments[t],!0));function n(e){return e=\"wy-\"+(e?e.replace(/^wy-/,\"\"):r().S4()+r().S4()),-1!==W.indexOf(e)&&(e=n(e+r().S4())),e}var o,s=n(e.options.id);Object.defineProperty(e,\"id\",{get:function(){return s}}),W.push(e.id),e.console=new u(this,e.options.logging),e.log=e.console.log,e.debug=e.console.debug,e.warn=e.console.warn,e.error=e.console.error,e.info=e.console.info,e.getId=function(t){return t?e.removeId(t)+\"__\"+e.id:e.id},e.removeId=function(t){return t?String(t).replace(new RegExp(\"__\"+e.getId()+\"$\"),\"\"):t},Object.defineProperty(e,\"version\",{get:function(){return H.version},configurable:!1}),e.version&&e.log(e.version);try{if(!e.options.url||\"/\"===e.options.url||!new URL(e.options.url))throw new Error;o=e.options.url,\"enforce\"===e.options.https?o=o.replace(/^http:/,\"https:\"):\"adaptive\"===e.options.https&&(o=o.replace(/^http:/,window.location.protocol))}catch(t){return void e.error('Required url not specified.\\nnew Weavy({ url: \"https://mytestsite.weavycloud.com/\" })')}Object.defineProperty(e,\"url\",{get:function(){return new URL(o)}}),e.user=null,e.data=null,e.isInitialized=!1,e.isBlocked=!1,e.isBuilt=!1,e.isLoading=!1,e.isLoaded=!1,e.events=new i(e),e.on=e.events.on,e.one=e.events.one,e.off=e.events.off,e.triggerEvent=e.events.triggerEvent,e.authentication=N.getAuthentication(e.url),void 0!==e.options.jwt||e.authentication.isProvided()||e.error(\"specify a jwt string or a provider function in your options\"),e.authentication.isProvided()&&e.authentication.isInitialized()||e.authentication.init(e.options.jwt),e.on(e.authentication,\"user\",(function(t,n){e.user=n.user,/^signed-in|signed-out|changed-user|user-error$/.test(n.state)&&(e.isLoading||(e.isLoaded&&e.whenLoaded.reset(),e.isLoaded=!1,e.data=null),\"changed-user\"===n.state?(e.triggerEvent(\"signed-out\",{id:-1}),e.triggerEvent(\"signed-in\",n)):e.triggerEvent(n.state,n),p()),\"updated\"!==n.state&&e.realtime.disconnectAndConnect()})),e.on(e.authentication,\"signing-in\",(function(){e.triggerEvent(\"signing-in\")})),e.on(e.authentication,\"clear-user\",(function(){e.triggerEvent(\"clear-user\")})),e.on(e.authentication,\"authentication-error\",(function(t,n){e.triggerEvent(\"authentication-error\",n)})),e.realtime=new m(e.url,e.authentication.getJwt.bind(e.authentication,!0)),e.nodes={},e.nodes.container=null,e.nodes.global=null,e.nodes.panels={},e.panels=new k(e),e.overlays=new O(e),e.apps=new Array,e.app=function(t){var n,o=M.getAppSelector(t);if(o.selector){try{n=e.apps.filter((function(e){return e.match(o.selector)})).pop()}catch(e){}n||(o.isConfig?(n=new M(e,t),e.apps.push(n),Promise.all([e.authentication.whenAuthorized(),e.whenInitialized()]).then((function(){n.fetchOrCreate()})).catch((function(t){e.warn(\"Could not fetchOrCreate app\",t||\"\")}))):e.warn(\"App \"+JSON.stringify(o.selector)+\" does not exist.\"+(o.isId?\"\":\" \\n Use weavy.app(\"+JSON.stringify(o.selector)+\") to create the app.\")))}return n};var a=[];function c(){a.forEach(clearTimeout),a=[]}function l(){var t=e.apps.reduce((function(e,t){return e&&t.isInitialized}),!0);return t}function d(){if(l())return h().resolve();var t=e.apps.reduce((function(e,t){return e.push(t.whenInitialized()),e}),[]);return Promise.all(t).then(d)}function p(){var t=new(h());if(!e.isLoading){e.isLoaded&&e.whenLoaded.reset(),e.isLoaded=!1,e.isLoading=!0,e.options.href=window.location.href;var n=new URL(D,e.url).href,o={plugins:e.options.plugins,version:e.version};e.options.lang&&(o.lang=e.options.lang),e.options.tz&&(o.tz=e.options.tz),e.options.theme&&(o.theme=e.options.theme),e.ajax(n,o,\"POST\",null,!0).then((function(n){e.triggerEvent(\"client-data\",n),t.resolve()}))}return t()}e.whenTimeout=function(e){var t,n=new(h()),o=function(){var e=a.indexOf(t);e>=0&&a.splice(e,1)};return a.push(t=setTimeout((function(){n.resolve()}),e)),n.then(o),n.catch((function(){return o(),clearTimeout(t),Promise.reject(new Error(\"Timeout cancelled\"))})),n.cancel=function(){o(),clearTimeout(t)},n},e.whenReady=new(h()),e.whenInitialized=new(h()),e.whenConnected=new(h()),e.whenBuilt=new(h()),e.whenLoaded=new(h()),e.on(\"init\",(function(){e.options.apps&&r().asArray(e.options.apps).forEach((function(t){e.app(t)}));p().then((function(){v.call(e).then((function(){e.whenReady.resolve()})),e.realtime.connect().then((()=>{e.on(e.realtime,\"reconnected.connection\",(function(){e.authentication.isAuthenticated()&&e.authentication.updateUserState(\"wvy.connection:reconnected\")})),e.on(e.realtime,\"close.connection\",(()=>e.whenConnected.reset())),e.realtime.subscribe(\"authenticate\"),e.on(e.realtime,\"authenticate\",(()=>e.authentication.updateUserState(\"weavy.realtime:authenticate\"))),e.whenConnected.resolve()}))}))})),e.on(\"after:init\",(function(){e.isInitialized=!0,e.whenInitialized.resolve()})),e.init=function(t){return e.options=r().assign(e.options,t),e.triggerEvent(\"init\"),e.whenInitialized()},e.on(\"client-data\",(function(t,n){if(e.data=n,e.isLoading=!1,!n)return e.error(\"Error loading client data\"),void e.whenLoaded.reject();let o=U.exec(e.version),i=U.exec(e.data.version);if(o&&i&&(delete o.groups.build,delete i.groups.build,!r().eqObjects(o.groups,i.groups,!0))){let t=\"Weavy client/server version mismatch! \\nclient: \"+e.version+\" \\nserver: \"+e.data.version,n=o.groups.major===i.groups.major,r=o.groups.minor===i.groups.minor;n&&r?e.warn(t):e.error(t)}!1===e.isBuilt&&(w.call(e),e.triggerEvent(\"build\",{container:e.nodes.container,global:e.nodes.global}),e.isBuilt=!0,e.whenBuilt.resolve()),Promise.all([d(),e.whenReady()]).then((function(){e.triggerEvent(\"load\"),e.isLoaded=!0,e.whenLoaded.resolve()}))}));var g=new Map;function w(){if(!e.getRoot()){var t=r().asElement(e.options.container)||document.documentElement,n=e.root=e.createRoot.call(e,t);e.nodes.container=n.root,e.nodes.global=n.container,e.nodes.global.classList.add(\"weavy-global\")}}function v(){var t,n,o=new URL(\"/dropin/client/ping\",e.url),i=\"hasStorageAccess\"in document,s=new(h()),a=new(h()),c=new(h()),l=new(h()),u=e.whenTimeout(3e3);if(!e.nodes.statusFrame){e.log(\"Frame Check: Started...\");var d=e.nodes.statusFrame=document.createElement(\"iframe\");d.className=\"weavy-status-check weavy-hidden\",d.style.display=\"none\",d.id=e.getId(\"weavy-status-check\"),d.setAttribute(\"name\",e.getId(\"weavy-status-check\"));return e.on(f,\"user-status\",{weavyId:e.getId(),windowName:e.getId(\"weavy-status-check\")},(function(o,c){var l,u,d,h=parseInt(c.id)===parseInt(e.authentication.user().id);e.debug(\"Frame Check: user-status received\",h),s.resolve(h),h?a.resolve():i?(u=r().asElement(\"<span>Third party cookies are required to use this page. </span>\"),(d=r().asElement('<button class=\"btn\" style=\"pointer-events: auto;\">Enable cookies</button>')).onclick=function(){e.log(\"Frame Check: Opening storage access request\"),l=window.open(new URL(\"/dropin/client/cookie-access\",e.url),e.getId(\"weavy-storage-access\")),f.registerContentWindow(l,e.getId(\"weavy-storage-access\"),e.getId(),e.url.origin)},u.appendChild(d),n=e.alert(u,!0),e.one(f,\"storage-access-granted\",{weavyId:!0,domain:e.url.origin},(function(){e.log(\"Frame Check: Storage access was granted, authenticating and reloading status check.\"),t&&(t.remove(),t=null),n&&(n.remove(),n=null);let o=e.getId();e.authentication.signIn().then((function(){e.debug(\"Frame Check: reloading status check\"),f.postToFrame(e.getId(\"weavy-status-check\"),o,{name:\"reload\"})}))}))):i||(t=e.alert(\"Allow third party cookies to use this page.\"))})),e.one(f,\"ready\",{weavyId:e.getId(),windowName:e.getId(\"weavy-status-check\")},(function(){e.debug(\"Frame Check: frame ready\"),l.resolve()})),u.then((function(){e.ajax(o).then((function(t){if(e.warn(\"Status check timeout. Please make sure your web server is properly configured.\"),!t.ok)return Promise.reject(new Error(\"Error fetching status url: \"+t.statusText));if(t.headers.has(\"X-Frame-Options\")){let e=t.headers.get(\"X-Frame-Options\");if(\"DENY\"===e||\"SAMEORIGIN\"===e&&o.origin!==window.location.origin)return Promise.reject(new Error(\"Frames are blocked by header X-Frame-Options\"))}if(t.headers.has(\"Content-Security-Policy\")){let n=t.headers.get(\"Content-Security-Policy\").split(\";\").filter((function(e){return 0===e.indexOf(\"frame-ancestors\")})).pop();if(n){let t=n.split(\" \");if(t.splice(0,1),!t.filter((function(t){return\"'self'\"===t&&e.url.origin===window.location.origin||(t.indexOf(\"*\")?window.location.origin.endsWith(t.split(\"*\").pop()):t===window.location.origin)})).length)return Promise.reject(new Error(\"Frames blocked by header Content-Security-Policy: frame-ancestors\"))}}})).catch((function(t){e.error(\"Frame status error detected: \"+t.message)}))})),e.nodes.container.appendChild(e.nodes.statusFrame),e.whenTimeout(1).then((function(){e.nodes.statusFrame.src=o.href,e.isBlocked=!0;try{f.registerContentWindow(e.nodes.statusFrame.contentWindow,e.getId(\"weavy-status-check\"),e.getId(),e.url.origin)}catch(t){e.warn(\"Frame postMessage is blocked\",t),e.triggerEvent(\"frame-check\",{blocked:!0})}})),Promise.all([l(),a()]).then((function(){return e.log(\"Frame Check:\",\"OK\"),e.isBlocked=!1,u.cancel(),t&&(t.remove(),t=null),n&&(n.remove(),n=null),e.triggerEvent(\"frame-check\",{blocked:!1}),c.resolve({blocked:!1}),c()})).catch((function(t){return e.triggerEvent(\"frame-check\",{blocked:!0}),c.reject(new Error(\"Frame check failed: \"+t.message)),c()}))}}e.getRoot=function(t){return g.get(e.getId(t))},e.createRoot=function(t,n,o){var i=e.getId(n),s=r().asElement(t);if(s){if(g.has(i))return e.warn(\"Root already created\",i),g.get(i);var a=new I(e,s,i,o);return a.on(\"root-remove\",(()=>g.delete(i))),g.set(i,a),a}e.error(\"No parent container defined for createRoot\",i)},e.ajax=function(t,n,o,i){t=new URL(t,e.url),o=o||\"GET\",n=n&&\"string\"==typeof n&&n||\"GET\"!==o&&n&&JSON.stringify(n,r().sanitizeJSON)||n||\"\";var s=!(\"GET\"===o&&!n);if(!(t.origin===e.url.origin))return Promise.reject(new Error(\"weavy.ajax: Only requests to the weavy server are alllowed.\"));if(i=r().assign({method:o,mode:\"cors\",cache:s?\"no-cache\":\"default\",credentials:\"include\",headers:{\"Content-Type\":\"application/json\",\"X-Requested-With\":\"XMLHttpRequest\"},redirect:\"manual\",referrerPolicy:\"no-referrer-when-downgrade\"},i,!0),n&&\"GET\"!==o)i.body=n;else if(n){let e=new URLSearchParams(n);t.search=(t.search?t.search+\"&\":\"\")+e.toString()}return e.authentication.whenAuthenticated().then((function(){return e.authentication.getJwt().then((function(n){return\"string\"!=typeof n?Promise.reject(new Error(\"weavy.ajax: Provided JWT is empty!\")):(i.headers.Authorization=\"Bearer \"+n,window.fetch(t.toString(),i).then((function(n){return 401===n.status||403===n.status?(e.warn(\"weavy.ajax: JWT failed, trying again\"),e.authentication.getJwt(!0).then((function(e){return i.headers.Authorization=\"Bearer \"+e,window.fetch(t.toString(),i)}))):n})).then(r().processJSONResponse).catch((function(t){return e.error(\"weavy.ajax: request failed!\",t.message),Promise.reject(t)})))}))}))},e.destroy=function(t){var n=new(h()),o=[],r=e.triggerEvent(\"destroy\",{whenAllDestroyed:[]});return!1!==r?Promise.all(r.whenAllDestroyed||[]).then((function(){e.log(\"destroy: Removing roots\"),g.forEach((function(e){e.remove()})),e.log(\"destroy: clearing events\"),e.events.clear(),c();try{f.unregisterAll(e.getId())}catch(t){e.warn(\"weavy.destroy: could not unregister postal content windows\")}for(var r in W.splice(W.indexOf(e.getId()),1),t||0!==W.length||o.push(e.realtime.disconnect()),e)Object.prototype.hasOwnProperty.call(e,r)&&delete e[r];Promise.all(o).then((function(){n.resolve()}))})).catch((function(){n.reject()})):n.reject(),n()},e.navigation=new j(e),e.history=new L(e),e.plugins={};var y={},b=[],S=[];function E(t){if(t){if(Object.prototype.hasOwnProperty.call(y,t)){var n=y[t];if(n.dependencies.length&&n.dependencies.forEach((function(n){\"function\"!=typeof H.plugins[n]?e.error(\"plugin dependency needed by \"+t+\" is not loaded/registered:\",n):e.options.includePlugins&&!1!==e.options.plugins[n]||!e.options.includePlugins&&e.options.plugins[n]||e.error(\"plugin dependency needed by \"+t+\" is disabled:\",n),-1===S.indexOf(n)?(S.push(n),E(n)):e.error(\"You have circular Weavy plugin dependencies:\",t,n)})),Object.prototype.hasOwnProperty.call(y,t))return b.push(y[t]),delete y[t],S=[],!0}}else for(n in y)E(n);return!1}if(!1!==e.options.plugins){for(P in e.options.plugins=e.options.plugins||{},H.plugins)\"function\"==typeof H.plugins[P]?(e.options.includePlugins&&!1!==e.options.plugins[P]||!e.options.includePlugins&&e.options.plugins[P])&&(y[P]={name:P,dependencies:Array.isArray(H.plugins[P].dependencies)?H.plugins[P].dependencies:[]}):e.error(\"Registered plugin is not a plugin\",P,typeof H.plugins[P]);for(var C in E(),b){var P=b[C].name;e.debug(\"Running Weavy plugin:\",P),e.options.plugins[P]=r().assign(H.plugins[P].defaults,r().isPlainObject(e.options.plugins[P])?e.options.plugins[P]:{},!0),e.plugins[P]=new H.plugins[P](e,e.options.plugins[P])||!0}}!0===e.options.init&&e.init()};Object.defineProperty(H.prototype,\"type\",{get:()=>\"Weavy\"}),H.presets={noplugins:{includePlugins:!1},core:{includePlugins:!1,plugins:{alert:!0,filebrowser:!0,preview:!0,theme:!0}}},H.defaults={container:null,https:\"adaptive\",init:!0,includePlugins:!0,plugins:{deeplinks:!1},preload:!0,shadowMode:\"closed\",url:\"/\"},H.plugins={},Object.defineProperty(H,\"instances\",{get:function(){return W.slice()},configurable:!1}),Object.defineProperty(H,\"version\",{get:function(){return\"10.0.5\"},configurable:!1});const F=H;class B{constructor(e,t){var n=[];function o(t,n){n||(e.whenTimeout(5e3).then((function(){t.classList.remove(\"in\")})),e.whenTimeout(5200).then((function(){t.remove()}))),e.whenTimeout(1).then((function(){t.classList.add(\"in\")})),e.nodes.global.appendChild(t)}this.alert=e.alert=function(r,i){var s=document.createElement(\"div\");return s.className=t.className,r instanceof HTMLElement?s.appendChild(r):s.innerHTML=r,e.nodes.global?o(s,i):n.push([s,i]),e.log(\"Alert\\n\"+s.innerText),s},e.on(\"after:build\",(function(){n.forEach((function(t){o.apply(e,t)})),n=[]}))}}B.defaults={className:\"weavy-alert-message fade\"},F.plugins.alert=B;class z{constructor(e,t){const n=this;let o=new Map;this.getBadges=t=>e.ajax(\"dropin/badge/\"+t),this.get=e=>{n.getBadges(e.appId).then((t=>{e.triggerEvent(\"badge\",{count:t})}))},e.whenLoaded().then((()=>{for(var t=0;t<e.apps.length;t++){let r=e.apps[t];r.options.badge&&(o.set(r,window.setInterval((()=>n.get(r)),5e3)),r.whenLoaded().then((()=>{clearInterval(o.get(r)),o.delete(r),n.get(r)})),n.get(r))}})),e.on(\"message\",{name:\"badge\"},((e,t)=>{t.app&&t.app.options.badge&&t.app.triggerEvent(\"badge\",{count:t.count})})),e.on(\"destroy clear-user signed-out\",(function(){o.forEach((e=>window.clearInterval(e))),o.clear()}))}}z.defaults={},F.plugins.badges=z;class _{constructor(e,t){if(e.on(\"history\",(function(t,n){var o=e.options.plugins.deeplinks,r=n.globalState.panels.filter((function(e){return e.changedAt&&e.isOpen&&(!e.statusCode||200===e.statusCode)})),i=r.slice(-1),s=(o.multiple?r:i).map((function(e){return e.weavyUri}));return n.url=s.length?\"#\"+s.join(o.delimiter):n.url.split(\"#\")[0],n})),!e.history.getBrowserState()&&window.location.hash){var n=window.location.hash.replace(/^#/,\"\").split(t.delimiter),o=e.history.getStateFromUri(n);o.panels.length&&(e.debug(\"deeplinks: setting initial state\"),e.history.setBrowserState(o,\"replace\"))}}}_.defaults={multiple:!1,delimiter:\",\"},_.dependencies=[],F.plugins.deeplinks=_;class J{constructor(e,t){var n=!1,o=\"https://filebrowser.weavycloud.com\",r=o+\"/index10.html\",i=\"about:blank\",s=null,a=new(h()),c=null;e.on(f,\"addExternalBlobs\",e.getId(),(function(e){f.postToSource(c,e.data)})),e.on(f,\"file-browser-open\",e.getId(),(function(t){c=t,function(){if(!n){n=!0,console.debug(\"Using filebrowser: \",r);var t=window.top.document.location.origin;if(i=r+\"?origin=\"+t+\"&v=X&t=\"+Date.now().toString()+\"&weavyId=\"+e.getId(),!s||0===s.length){var c=e.getId(\"filebrowser\");(s=document.createElement(\"iframe\")).id=c,s.name=c,s.src=i,s.className=\"weavy-filebrowser-frame\",e.nodes.panels.filebrowser.node.appendChild(s),f.registerContentWindow(s.contentWindow,c,e.getId(),o)}s.addEventListener(\"load\",(()=>{a.resolve()}),{once:!0})}return a.promise()}().then((()=>{s.style.display=\"block\"}))})),e.on(f,\"file-browser-close\",e.getId(),(function(e){s.style.display=\"none\"})),e.on(\"before:build\",(function(){e.nodes.panels.filebrowser||(e.nodes.panels.filebrowser=e.panels.createContainer(),e.nodes.panels.filebrowser.node.classList.add(\"weavy-filebrowser\"),e.nodes.global.appendChild(e.nodes.panels.filebrowser.node))}))}}J.defaults={},F.plugins.filebrowser=J;class X{constructor(e,t){function n(t,n){var o;if(e.log(\"maximize\",null!==t?t:\"toggle\",this.panelId),!1===t||this.maximized&&!0!==t){if(this.initialStyles){for(o in e.debug(\"restoring maximize styles\"),this.initialStyles)Object.prototype.hasOwnProperty.call(this.initialStyles,o)&&(this.node.style[o]=this.initialStyles[o]);delete this.initialStyles}this.node.style.position=this.initialPosition,this.node.style.zIndex=this.initialZIndex,delete this.initialPosition,delete this.initialZIndex,this.maximized=!1}else{if(void 0===this.initialPosition&&(this.initialPosition=this.node.style.position),void 0===this.initialZIndex&&(this.initialZIndex=this.node.style.zIndex),this.node.style.position=\"fixed\",this.node.style.zIndex=2147483647,n&&void 0===this.initialStyles){e.debug(\"setting maximize styles\");var r={};for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=this.node.style[o],this.node.style[o]=n[o]);this.initialStyles=r}this.maximized=!0}}e.on(\"panel-added\",(function(t,o){if(o.panel.maximize=n.bind(o.panel),o.attributes.controls&&(!0===o.attributes.controls||o.attributes.controls.maximize)){var r=o.attributes.controls.maximize,i=r&&\"boolean\"!=typeof r&&r;e.debug(\"maximize: adding panel control\",o.panelId);var s=o.panel.node.querySelector(\".weavy-controls\");s&&function(t,o,r){var i=document.createElement(\"div\");i.className=\"weavy-icon\",i.title=\"Maximize\",i.innerHTML='<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M4,4H20V20H4V4M6,8V18H18V8H6Z\" /></svg>',e.on(i,\"click\",n.bind(o,null,r)),t.appendChild(i)}(s,o.panel,i)}}))}}X.defaults={},X.dependencies=[],F.plugins.maximize=X},77:(e,t,n)=>{\"use strict\";e.exports=n.p+\"weavy-dropin.css\"},350:e=>{\"use strict\";e.exports=null}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if(\"object\"==typeof globalThis)return globalThis;try{return this||new Function(\"return this\")()}catch(e){if(\"object\"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+\"\");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName(\"script\");o.length&&(e=o[o.length-1].src)}if(!e)throw new Error(\"Automatic publicPath is not supported in this browser\");e=e.replace(/#.*$/,\"\").replace(/\\?.*$/,\"\").replace(/\\/[^\\/]+$/,\"/\"),n.p=e})(),n(77);var o=n(253);return o=o.default})()}));\n\n//# sourceURL=webpack:///./node_modules/@weavy/dropin-js/dist/weavy-dropin.js?");

/***/ }),

/***/ "./node_modules/@weavy/dropin-js/dist/weavy-dropin.css":
/*!*************************************************************!*\
  !*** ./node_modules/@weavy/dropin-js/dist/weavy-dropin.css ***!
  \*************************************************************/
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {

"use strict";
eval("module.exports = __webpack_require__.p + \"css/weavy-dropin.css\";\n\n//# sourceURL=webpack:///./node_modules/@weavy/dropin-js/dist/weavy-dropin.css?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	!function() {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = function(module) {
/******/ 			var getter = module && module.__esModule ?
/******/ 				function() { return module['default']; } :
/******/ 				function() { return module; };
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	!function() {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = function(exports, definition) {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/global */
/******/ 	!function() {
/******/ 		__webpack_require__.g = (function() {
/******/ 			if (typeof globalThis === 'object') return globalThis;
/******/ 			try {
/******/ 				return this || new Function('return this')();
/******/ 			} catch (e) {
/******/ 				if (typeof window === 'object') return window;
/******/ 			}
/******/ 		})();
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	!function() {
/******/ 		__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	!function() {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = function(exports) {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	}();
/******/ 	
/******/ 	/* webpack/runtime/publicPath */
/******/ 	!function() {
/******/ 		var scriptUrl;
/******/ 		if (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + "";
/******/ 		var document = __webpack_require__.g.document;
/******/ 		if (!scriptUrl && document) {
/******/ 			if (document.currentScript)
/******/ 				scriptUrl = document.currentScript.src
/******/ 			if (!scriptUrl) {
/******/ 				var scripts = document.getElementsByTagName("script");
/******/ 				if(scripts.length) scriptUrl = scripts[scripts.length - 1].src
/******/ 			}
/******/ 		}
/******/ 		// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration
/******/ 		// or pass an empty string ("") and set the __webpack_public_path__ variable from your code to use your own logic.
/******/ 		if (!scriptUrl) throw new Error("Automatic publicPath is not supported in this browser");
/******/ 		scriptUrl = scriptUrl.replace(/#.*$/, "").replace(/\?.*$/, "").replace(/\/[^\/]+$/, "/");
/******/ 		__webpack_require__.p = scriptUrl + "../";
/******/ 	}();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module doesn't tell about it's top-level declarations so it can't be inlined
/******/ 	__webpack_require__("./node_modules/@weavy/dropin-js/dist/weavy-dropin.css");
/******/ 	var __webpack_exports__ = __webpack_require__("./js/index.js");
/******/ 	
/******/ })()
;